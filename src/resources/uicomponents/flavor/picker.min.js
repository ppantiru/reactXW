'use strict';require(["jquery"],function(b){var m=function(a){a.trigger("xwiki:flavorpicker:updated",{elements:a[0]})},t=function(){q();r()},r=function(){var a="$escapetool.javascript($services.flavor.getSearchValidFlavorsStatusURL(''))";b(".xwiki-flavor-picker");a+=encodeURIComponent(b(".xwiki-flavor-picker").attr("data-namespace"));b.getJSON(a).done(function(c){var d=c.state,f=b("#xwiki-flavor-picker-progress-background");if(f.length){var e=b("#xwiki-flavor-picker-progress-bar");f.find("input").attr("value",
d);"RUNNING"==d?(f.removeClass("hidden"),e.css("width",100*c.progress.offset+"%")):f.addClass("hidden");n()}}).fail(function(){new XWiki.widgets.Notification("$escapetool.javascript($services.localization.render('flavor.picker.ajaxError'))","error")})},q=function(){var a="$escapetool.javascript($doc.getURL('get', 'xpage=flavor/picker_flavors'))",c=b(".xwiki-flavor-picker");a+="&namespace="+encodeURIComponent(c.attr("data-namespace"));b.getJSON(a).done(function(d){b.each(d,function(f,e){u(f,e)});p(b(".xwiki-flavor-picker"))}).fail(function(d){new XWiki.widgets.Notification("$escapetool.javascript($services.localization.render('flavor.picker.ajaxError'))",
"error")})},u=function(a,c){var d=b(".xwiki-flavor-picker"),f=d.find('input[name="fieldName"]').attr("value");d=d.find("ul");var e=c.id.id+":::"+c.id.version.value;if(0==d.find('input[value="'+e+'"]').length){var h=b('<li class="xwiki-flavor-picker-option"/>');h.append(b('<input type="radio"/>').attr("name",f).attr("value",e).attr("id",f+"_"+a));h.append("<span class=\"xwiki-flavor-picker-option-icon\">$escapetool.javascript($services.icon.renderHTML('wiki'))</span>");e=b("<div/>");var g=b("<div/>");
g.attr("for",f+"_"+a);a=null!=c.name&&""!=c.name?c.name:c.id.id;null!=c.website&&""!=c.website?g.append(b('<a class="popup"/>').attr("href",c.website).text(a)):g.text(a);g.append(" ");g.append(b("<small/>").text(c.id.version.value));null!=c.rating&&0<c.rating&&g.append(Array(Math.round(c.rating)).join("$escapetool.javascript($services.icon.renderHTML('star'))"));e.append(g);if(0<c.authors.length){a=b('<p class="authors"/>');var k=b("<small/>");k.text("$escapetool.javascript($services.localization.render('flavor.picker.authorsBy')) ");
b.each(c.authors,function(v,l){0<v&&k.append(", ");null!=l.url&&""!=l.url?k.append(b("<a/>").attr("href",l.url).text(l.name)):k.append(l.name)});a.append(k);e.append(a)}null!=c&&""!=c.summary&&e.append(b('<p class="xHint"/>').text(c.summary));h.append(b('<input type="hidden" name="match"/>').attr("value",JSON.stringify(c)));h.append(e);d.append(h)}},n=function(){var a=b("#xwiki-flavor-picker-progress-background");a.length&&"FINISHED"!=a.find("input").attr("value")&&setTimeout(t,100)},w=function(a){var c=
b(".xwiki-flavor-picker");a&&""!==b.trim(a)?c.find("li").each(function(d){d=b(this);-1<d.find('input[name="match"]').attr("value").toLowerCase().indexOf(a)?d.removeClass("hidden"):d.addClass("hidden")}):c.find("li").removeClass("hidden")},p=function(a){a.find(".xwiki-flavor-picker-option").click(function(c){c=b(this);var d=c.parents(".xwiki-flavor-picker");d.find(".xwiki-flavor-picker-option-selected").removeClass("xwiki-flavor-picker-option-selected");c.find("input").prop("checked",!0);c.addClass("xwiki-flavor-picker-option-selected");
m(d)});a.find(".xwiki-flavor-picker-option a.popup").click(function(c){window.open(this.href,"flavor-popup",config="height=600, width=700, toolbar=no, menubar=no, scrollbars=yes, resizable=yes, location=no, directories=no, status=yes");return!1});m(a)};b(window).ready(function(){p(b(".xwiki-flavor-picker"));b("input.xwiki-flavor-picker-filter").keyup(function(){var a=b(this).val();w(a)});b(".xwiki-flavor-picker-noflavor").click(function(a){a=b(this).parents(".xwiki-flavor-picker");a.find(".xwiki-flavor-picker-option-selected").removeClass("xwiki-flavor-picker-option-selected");
m(a)});n()})});

//# sourceMappingURL=picker.min.js.map
