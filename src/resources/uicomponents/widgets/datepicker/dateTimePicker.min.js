'use strict';var XWiki=function(d){function f(a){a.getViewer().select("input[type=text]").each(function(b){b.name.endsWith("_0_"+a.getName())&&new d.DateTimePicker(b,$(a.getPropertyId("dateFormat")).value)})}function g(a){if("Date"==$("type-"+a.getName()).value){var b=$(a.getPropertyId("emptyIsToday"));if("text"==b.type){b.type="checkbox";b.checked="1"==b.value;b.value="1";var c=b.up("dd");c.previous("dt").down("label").insert({top:b});c.remove();b.insert({after:new Element("input",{type:"hidden",
value:"0",name:b.name})})}$(a.getPropertyId("dateFormat"));f(a)}}d.DateTimePicker=Class.create({timeStampClassNamePattern:/^t\d+$/,initialize:function(a,b){this.input=$(a);this.input.writeAttribute("autocomplete","off");a=this._trigger.bindAsEventListener(this);this.input.observe("focus",a).observe("click",a);this.formatter=new Externals.SimpleDateFormat(b);this.timePickerEnabled=this._isTimePickerEnabled()},_isTimePickerEnabled:function(){var a=this.formatter.format(new Date(1876,1,1,23,59,0,0));
return 0<=a.indexOf("23")&&0<=a.indexOf("59")},_getDate:function(){if(!this.input._timestamp){this.input._timestamp=this.input.readAttribute("data-timestamp")||(new Date).getTime();for(var a=$w(this.input.className),b=0;b<a.length;b++)this.timeStampClassNamePattern.test(a[b])&&(this.input._timestamp=parseInt(a[b].substring(1)))}return new Date(this.input._timestamp)},_trigger:function(a){this.input.calendar_date_select||this.input.calendar_date_select_closing||new Externals.CalendarDateSelect(this.input,
{time:this.timePickerEnabled,date:this._getDate(),clear_button:!1,formatter:this,before_close:function(){this.calendar_date_select_closing=!0;this.calendar_date_select.selection_made&&(a.element()._timestamp=this.calendar_date_select.selected_date.getTime())},after_close:function(){this.calendar_date_select_closing=void 0}})},format:function(a){return this.formatter.format(a)},parse:function(a){return new Date(a)}});var h=function(a){(a&&a.memo.elements||[$("body")]).each(function(b){$(b).select("input.datetime").each(function(c){if(!c.hasClassName("initialized")){var k=
c.readAttribute("data-format")||c.title;new d.DateTimePicker(c,k);c.addClassName("initialized")}})})},e=function(a,b){if(a||"undefined"!=typeof Externals&&Externals.SimpleDateFormat&&Externals.CalendarDateSelect)return document.observe("xwiki:class:displayField",function(c){g(c.memo.field)}),document.observe("xwiki:class:previewField",function(c){c=c.memo.field;"Date"==$("type-"+c.getName()).value&&f(c)}),(b=$("fields"))?b.childElements().each(function(c){c=new d.FormField(c);c.getConfig()&&g(c)}):
h(a),!0;b=b||0;3>b?("undefined"!=typeof console&&console.warn&&console.warn("Cannot initialize DateTimePicker due to missing dependencies. Waiting a bit before trying again."),setTimeout(e.bind(this,a,b+1),100)):"undefined"!=typeof console&&console.error&&console.error("Failed to initialize DateTimePicker due to missing dependencies: SimpleDateFormat and CalendarDateSelect.")};d.domIsLoaded&&e()||document.observe("xwiki:dom:loaded",e);document.observe("xwiki:dom:updated",h);return d}(XWiki||{});

//# sourceMappingURL=dateTimePicker.min.js.map
