'use strict';var XWiki=function(a){a.widgets=a.widgets||{};Object.extend(a,{constants:{anchorSeparator:"#",docextraCommentsAnchor:"Comments",docextraAttachmentsAnchor:"Attachments",docextraHistoryAnchor:"History",docextraInformationAnchor:"Information"},resource:{get:function(b,d){for(var c="",e=["Attachments"],g=[a.EntityType.DOCUMENT],f=0;f<e.length;f++)if(b.endsWith(a.constants.anchorSeparator+e[f])){c=e[f];b=b.substr(0,b.length-(c.length+1));d=d||g[f];break}d?d=a.Model.resolve(b,d):(d=a.Model.resolve(b,
a.EntityType.ATTACHMENT),d.parent||(d=a.Model.resolve(b,a.EntityType.DOCUMENT),d.parent||(b=a.Model.resolve(b,a.EntityType.SPACE),b.parent&&(d=b))));return this.fromEntityReference(d,c)},fromEntityReference:function(b,d){var c=b.extractReference(a.EntityType.WIKI);c=c&&c.name||a.currentWiki;var e=b.extractReference(a.EntityType.SPACE);e=e&&e.name||a.currentSpace;var g=b.extractReference(a.EntityType.DOCUMENT);g=g&&g.name||a.currentPage;b=(b=b.extractReference(a.EntityType.ATTACHMENT))&&b.name||"";
var f=new a.DocumentReference(c,e,g),h=a.Model.serialize(f.relativeTo(new a.WikiReference(c))),k=a.Model.serialize(f.parent);f=a.Model.serialize(f);return{wiki:c,space:e,prefixedSpace:k,fullName:h,prefixedFullName:f,name:g,attachment:b,anchor:d}},asEntityReference:function(b){var d;b=[b.wiki,b.space,b.name,b.attachment];for(var c=0;c<b.length;c++)b[c]&&(d=new a.EntityReference(b[c],c,d));return d},serialize:function(b){var d=a.Model.serialize(this.asEntityReference(b));b.anchor&&(0<d.length&&(d+=
a.constants.anchorSeparator),d+=b.anchor);return d}},getResource:function(b){return this.resource.get(b)},displayDocExtra:function(b,d,c){var e=function(h){var k=document.getElementById(h+"tab"),m=document.getElementById(h+"pane");null!=window.activeDocExtraTab&&(window.activeDocExtraTab.className="",window.activeDocExtraPane.className="hidden");window.activeDocExtraTab=k;window.activeDocExtraPane=m;window.activeDocExtraTab.className="active";window.activeDocExtraPane.className="";k.blur();document.fire("xwiki:docextra:activated",
{id:h})};if(-1!=$(b+"pane").className.indexOf("empty")){null!=window.activeDocExtraPane&&(window.activeDocExtraPane.className="invisible");$("docextrapanes").className="loading";var g="",f=window.location.search.toQueryParams().minify;f&&"false"==f&&(g="&minify=false");new Ajax.Request(window.docgeturl+"?xpage=xpart&vm="+d+g,{method:"get",onSuccess:function(h){var k=document.body.previous("head");h=h.responseText;var m=new Element("div");m.innerHTML=h;m.select("link").each(function(l){0==k.select('link[href="'+
l.readAttribute("href")+'"][type="'+l.readAttribute("type")+'"]').length&&k.insert(new Element("link",{rel:"stylesheet",type:l.type,href:l.readAttribute("href")}));l.remove()});m.select("script").each(function(l){l.src&&0==k.select('script[src="'+l.readAttribute("src")+'"][type="'+l.readAttribute("type")+'"]').length&&k.insert(new Element("script",{type:l.type,src:l.readAttribute("src")}))});var n=$(b+"pane");m.childElements().forEach(function(l){n.insert(l)});document.fire("xwiki:dom:updated",{elements:[$(b+
"pane")]})},onComplete:function(h){401==h.status&&document.location.reload();$("docextrapanes").className="";document.fire("xwiki:docextra:loaded",{id:b,element:$(b+"pane")});e(b);c&&($(b+"anchor").id=b,location.href="#"+b,$(b).id=b+"anchor")}})}else e(b),c&&($(b+"anchor").id=b,location.href="#"+b,$(b).id=b+"anchor")},makeRenderingErrorsExpandable:function(b){$(b||"body").select(".xwikirenderingerror").each(function(d){""!==d.next().innerHTML&&d.next().hasClassName("xwikirenderingerrordescription")&&
(d.style.cursor="pointer",d.title="$escapetool.javascript($services.localization.render('platform.core.rendering.error.readTechnicalInformation'))",Event.observe(d,"click",function(c){c.element().next().toggleClassName("hidden")}))})},fixLinksTargetAttribute:function(b){b=$(b||"body").select("a[rel]");for(var d=0;d<b.length;d++){var c=b[d];if(!c.up(".xRichTextEditor")&&c.getAttribute("href")&&c.getAttribute("rel")){for(var e=c.getAttribute("rel").split(" "),g=0;g<e.length;g++)if("_"==e[g].charAt(0)){c.target=
e[g].substring(1);break}else if("external"==e[g]){c.target="_blank";break}c.target&&"_self"!=c.target&&"_parent"!=c.target&&"_top"!=c.target&&(g=function(f,h){for(var k=0;k<f.length;++k)if(f[k]==h)return!0;return!1},g(e,"noopener")||e.push("noopener"),g(e,"noreferrer")||e.push("noreferrer"),c.setAttribute("rel",e.join(" ")))}}},insertSectionEditLinks:function(b){if($xwiki.hasSectionEdit()&&"xwiki/1.0"!=a.docsyntax&&"view"==a.contextaction&&a.hasEdit){var d=1;b=$(b||"body");if(b="xwikicontent"==b.id?
b:b.down("#xwikicontent")){b=b.childNodes;for(var c=new RegExp("H[1-"+$xwiki.getSectionEditingDepth()+"]"),e=0;e<b.length;e++){var g=$(b[e]);if(c.test(g.nodeName)&&!g.classList.contains("wikigeneratedheader")&&!g.down("a.edit_section")){var f=document.createElement("a");f.className="edit_section";f.toggle(g.visible()&&!g.hasClassName("hidden"));f.setAttribute("role","button");f.title=$jsontool.serialize($services.localization.render("edit"));f.innerHTML=$jsontool.serialize($services.icon.renderHTML("pencil"));
var h=document.createElement("span");h.className="sr-only";h.textContent=$jsontool.serialize($services.localization.render("edit"));f.appendChild(h);a.hasRenderer?f.href=window.docediturl+"?section="+d:(f.className+=" disabled",f.setAttribute("aria-disabled","true"),f.setAttribute("tabindex","-1"),f.title=$jsontool.serialize($services.localization.render("platform.core.rendering.noRendererForSectionEdit")),f.href="#"+(g.id||""));g.appendChild(f);d++}}}}},insertCreatePageFromTemplateModalBoxes:function(b){if("xwiki/1.0"!=
a.docsyntax&&"view"==a.contextaction&&a.hasEdit&&a.widgets.ModalPopup){a.widgets.CreatePagePopup=Class.create(a.widgets.ModalPopup,{initialize:function($super,e){var g=new Element("div",{"class":"modal-popup"});g.insert(e.content);$super(g,{show:{method:this.showDialog,keys:[]},close:{method:this.closeDialog,keys:["Esc"]}},{displayCloseButton:!0,verticalPosition:"center",backgroundColor:"#FFF"});this.showDialog();this.setClass("createpage-modal-popup")}});b=$(b||"body").select("span.wikicreatelink:not(.skipCreatePagePopup)");
for(var d=0;d<b.length;d++)b[d].down("a").observe("click",function(c){new Ajax.Request(c.findElement("a").href.replace(/#.*$/,""),{method:"get",parameters:{xpage:"createinline",ajax:1},onSuccess:function(e){var g=e.getHeader("redirect");if(g)window.location=g;else{var f=new a.widgets.Notification("$escapetool.javascript($services.localization.render('core.create.popup.loading'))","inprogress");g=new Element("link",{rel:"stylesheet",type:"text/css",href:'$xwiki.getSkinFile("uicomponents/widgets/select/select.css", true)'});
$(document.head).insert(g);require(["$xwiki.getSkinFile('js/xwiki/create.js', true)","$xwiki.getSkinFile('uicomponents/widgets/select/select.js', true)"],function(h){new a.widgets.CreatePagePopup({content:e.responseText});f.hide()})}},onFailure:function(){(new a.widgets.Notification("$escapetool.javascript($services.localization.render('core.create.ajax.error'))","error",{inactive:!0})).show()}});c.stop()})}},watchlist:{actionsMap:{tmWatchDocument:"adddocument",tmUnwatchDocument:"removedocument",
tmWatchSpace:"addspace",tmUnwatchSpace:"removespace",tmWatchWiki:"addwiki",tmUnwatchWiki:"removewiki"},flowMap:{tmWatchDocument:"tmUnwatchDocument",tmUnwatchDocument:"tmWatchDocument",tmWatchSpace:"tmUnwatchSpace",tmUnwatchSpace:"tmWatchSpace",tmWatchWiki:"tmUnwatchWiki",tmUnwatchWiki:"tmWatchWiki"},executeAction:function(b){new Ajax.Request(window.docgeturl+"?xpage=watch&do="+this.actionsMap[b.id],{method:"get",onComplete:function(){"A"==b.nodeName?(b.up().toggleClassName("hidden"),$(a.watchlist.flowMap[b.id]).up().toggleClassName("hidden")):
(b.toggleClassName("hidden"),$(a.watchlist.flowMap[b.id]).toggleClassName("hidden"))}})},initialize:function(b){b=$(b||"body");for(var d in a.watchlist.actionsMap){var c=b.down("#"+d);if(c){"A"!=c.nodeName&&(c=$(d).down("A"));if(!c)break;c.stopObserving("click");c.observe("click",function(e){Event.stop(e);for(e=e.element();""==e.id;)e=e.up();a.watchlist.executeAction(e)})}}}},cookies:{create:function(b,d,c){if(c){var e=new Date;e.setTime(e.getTime()+864E5*c);c="; expires="+e.toGMTString()}else c=
"";document.cookie=b+"="+encodeURIComponent(d)+c+"; path=/"},read:function(b){b+="=";for(var d=document.cookie.split(";"),c=0;c<d.length;c++){for(var e=d[c];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return decodeURIComponent(e.substring(b.length,e.length))}return null},erase:function(b){a.cookies.create(b,"",-1)}},togglePanelVisibility:function(b){b=$(b);b.toggleClassName("collapsed")},registerPanelToggle:function(b){$(b||"body").select(".panel .xwikipaneltitle").each(function(d){d.observe("click",
this.togglePanelVisibility.bind(this,d.up(".panel")))}.bind(this))},extractFileName:function(b){b=$(b);if(b.files&&0<b.files.length)return b.files[0].name;if("C:\\fakepath\\"==b.value.substr(0,12))return b.value.substr(12);var d=b.value.lastIndexOf("/");if(0<=d)return b.value.substr(d+1);d=b.value.lastIndexOf("\\");return 0<=d?b.value.substr(d+1):b.value},initialize:function(){if("undefined"==typeof this.isInitialized||0==this.isInitialized)"undefined"==typeof a.lastScriptLoaded?a.failedInit=!0:(this.isInitialized=
!0,document.fire("xwiki:dom:loading"),document.observe("xwiki:dom:updated",function(b){b.memo.elements.each(this._addBehaviour.bind(this))}.bindAsEventListener(this)),this._addBehaviour(),this.domIsLoaded=!0,document.fire("xwiki:dom:loaded"))},_addBehaviour:function(b){b=b||$("body");this.makeRenderingErrorsExpandable(b);this.fixLinksTargetAttribute(b);this.insertSectionEditLinks(b);this.insertCreatePageFromTemplateModalBoxes(b);this.watchlist.initialize(b);this.registerPanelToggle(b)}});return a}(XWiki||
{});document.observe("dom:loaded",XWiki.initialize.bind(XWiki));function showsubmenu(a){if("span"==a.lastChild.tagName.toLowerCase()){window.hidetimer&&(window.hideelement==a.lastChild?(clearTimeout(window.hidetimer),window.hidetimer=null,window.hideelement=null):doHide());var b=Element.positionedOffset(a);a.lastChild.style.left=b[0]-10+"px";a.lastChild.style.top=b[1]+a.offsetHeight+"px";a.lastChild.className=a.lastChild.className.replace("hidden","visible")}}
function hidesubmenu(a){"span"==a.lastChild.tagName.toLowerCase()&&(window.hideelement=a.lastChild,window.hidetimer=setTimeout(doHide,100))}function doHide(){window.hideelement.className=window.hideelement.className.replace("visible","hidden");clearTimeout(window.hidetimer);window.hidetimer=null;window.hideelement=null}function toggleClass(a,b){eltHasClass(a,b)?rmClass(a,b):a.className+=" "+b}function addClass(a,b){eltHasClass(a,b)||(a.className+=" "+b)}
function eltHasClass(a,b){return a.className?(new RegExp("\\b"+b+"\\b")).test(a.className):!1}function rmClass(a,b){a.className=a.className.replace(new RegExp("\\s*\\b"+b+"\\b"),"")}function openURL(a){(win=open(a,"win","titlebar=0,width=990,height=500,resizable,scrollbars"))&&win.focus()}
function openHelp(){(win=open("http://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/XWikiSyntax/WebHome?xpage=print","XWikiSyntax","titlebar=0,width=750,height=480,resizable,scrollbars"))&&win.focus()}function updateName(a,b,d){var c=a.value;c=noaccent(c);0!=d&&(c=c.replace(/class$/gi,""));null==b?a.value=c:b.value=c;return""==c?!1:!0}
function noaccent(a){a=a.replace(/[\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u0100\u0102\u0104\u01cd\u01de\u01e0\u01fa\u0200\u0202\u0226]/g,"A");a=a.replace(/[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0101\u0103\u0105\u01ce\u01df\u01e1\u01fb\u0201\u0203\u0227]/g,"a");a=a.replace(/[\u00c6\u01e2\u01fc]/g,"AE");a=a.replace(/[\u00e6\u01e3\u01fd]/g,"ae");a=a.replace(/[\u008c\u0152]/g,"OE");a=a.replace(/[\u009c\u0153]/g,"oe");a=a.replace(/[\u00c7\u0106\u0108\u010a\u010c]/g,"C");a=a.replace(/[\u00e7\u0107\u0109\u010b\u010d]/g,
"c");a=a.replace(/[\u00d0\u010e\u0110]/g,"D");a=a.replace(/[\u00f0\u010f\u0111]/g,"d");a=a.replace(/[\u00c8\u00c9\u00ca\u00cb\u0112\u0114\u0116\u0118\u011a\u0204\u0206\u0228]/g,"E");a=a.replace(/[\u00e8\u00e9\u00ea\u00eb\u0113\u0115\u0117\u0119\u011b\u01dd\u0205\u0207\u0229]/g,"e");a=a.replace(/[\u011c\u011e\u0120\u0122\u01e4\u01e6\u01f4]/g,"G");a=a.replace(/[\u011d\u011f\u0121\u0123\u01e5\u01e7\u01f5]/g,"g");a=a.replace(/[\u0124\u0126\u021e]/g,"H");a=a.replace(/[\u0125\u0127\u021f]/g,"h");a=a.replace(/[\u00cc\u00cd\u00ce\u00cf\u0128\u012a\u012c\u012e\u0130\u01cf\u0208\u020a]/g,
"I");a=a.replace(/[\u00ec\u00ed\u00ee\u00ef\u0129\u012b\u012d\u012f\u0131\u01d0\u0209\u020b]/g,"i");a=a.replace(/[\u0132]/g,"IJ");a=a.replace(/[\u0133]/g,"ij");a=a.replace(/[\u0134]/g,"J");a=a.replace(/[\u0135]/g,"j");a=a.replace(/[\u0136\u01e8]/g,"K");a=a.replace(/[\u0137\u0138\u01e9]/g,"k");a=a.replace(/[\u0139\u013b\u013d\u013f\u0141]/g,"L");a=a.replace(/[\u013a\u013c\u013e\u0140\u0142\u0234]/g,"l");a=a.replace(/[\u00d1\u0143\u0145\u0147\u014a\u01f8]/g,"N");a=a.replace(/[\u00f1\u0144\u0146\u0148\u0149\u014b\u01f9\u0235]/g,
"n");a=a.replace(/[\u00d2\u00d3\u00d4\u00d5\u00d6\u00d8\u014c\u014e\u0150\u01d1\u01ea\u01ec\u01fe\u020c\u020e\u022a\u022c\u022e\u0230]/g,"O");a=a.replace(/[\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014d\u014f\u0151\u01d2\u01eb\u01ed\u01ff\u020d\u020f\u022b\u022d\u022f\u0231]/g,"o");a=a.replace(/[\u0156\u0158\u0210\u0212]/g,"R");a=a.replace(/[\u0157\u0159\u0211\u0213]/g,"r");a=a.replace(/[\u015a\u015c\u015e\u0160\u0218]/g,"S");a=a.replace(/[\u015b\u015d\u015f\u0161\u0219]/g,"s");a=a.replace(/[\u00de\u0162\u0164\u0166\u021a]/g,
"T");a=a.replace(/[\u00fe\u0163\u0165\u0167\u021b\u0236]/g,"t");a=a.replace(/[\u00d9\u00da\u00db\u00dc\u0168\u016a\u016c\u016e\u0170\u0172\u01d3\u01d5\u01d7\u01d9\u01db\u0214\u0216]/g,"U");a=a.replace(/[\u00f9\u00fa\u00fb\u00fc\u0169\u016b\u016d\u016f\u0171\u0173\u01d4\u01d6\u01d8\u01da\u01dc\u0215\u0217]/g,"u");a=a.replace(/[\u0174]/g,"W");a=a.replace(/[\u0175]/g,"w");a=a.replace(/[\u00dd\u0176\u0178\u0232]/g,"Y");a=a.replace(/[\u00fd\u00ff\u0177\u0233]/g,"y");a=a.replace(/[\u0179\u017b\u017d]/g,
"Z");a=a.replace(/[\u017a\u017c\u017e]/g,"z");a=a.replace(/[\u00df]/g,"SS");return a=a.replace(/[^a-zA-Z0-9_]/g,"")}function prepareName(a){var b=a.register_first_name.value,d=a.register_last_name.value;a=a.xwikiname;""!=b&&(b=b.substring(0,1).toUpperCase()+b.substring(1));""!=d&&(d=d.substring(0,1).toUpperCase()+d.substring(1));""==a.value&&(a.value=noaccent(b+d))}
function checkAdvancedContent(a){result=!1;if(!document.forms.edit)return!0;data=document.forms.edit.content.value;myRE=/<\/?(html|body|img|a|i|b|embed|script|form|input|textarea|object|font|li|ul|ol|table|center|hr|br|p) ?([^>]*)>/ig;(results=data.match(myRE))&&0<results.length&&(result=!0);myRE2=/(#(set|include|if|end|for)|#(#) Advanced content|public class|\/* Advanced content *\/)/ig;(results=data.match(myRE2))&&0<results.length&&(result=!0);return 1==result?confirm(a):!0}
window.shortcut=Object({all_shortcuts:function(){var a=[];Object.values(this._listeners).forEach(function(b,d){Object.values(b).forEach(function(c,e){a=a.concat(c.get_registered_combos())})});return a},type:Object({SIMPLE:"simple",COUNTING:"counting",SEQUENCE:"sequence"}),add:function(a,b,d){require(["$services.webjars.url('org.webjars:Keypress', 'keypress.min.js')","jquery"],function(c){d=d?d:{};var e={keys:shortcut._format_shortcut_combination(a),is_solitary:!0};c=shortcut._get_or_create_listener("target"in
d?d.target:document,"disable_in_input"in d&&d.disable_in_input?shortcut._listeners.disabled_in_inputs:shortcut._listeners.enabled_in_inputs,c);if("type"in d&&-1<Object.values(shortcut.type).indexOf(d.type)){switch(d.type){case shortcut.type.COUNTING:e.is_counting=!0;e.is_unordered=!1;break;case shortcut.type.SEQUENCE:e.is_sequence=!0,e.is_exclusive=!0}e.on_keydown=shortcut._wrap_shortcut_call(b,d.type)}else"type"in d&&console.warn("The parameter ["+d.type+"] for the shortcut ["+a+"] type deprecated."),
e.on_keydown=shortcut._wrap_shortcut_call(b,shortcut.type.SIMPLE);c.register_combo(e);var g=["target","disable_in_input","type"];Object.keys(d).forEach(function(f){-1===g.indexOf(f)&&console.warn("The parameter ["+f+"] for the shortcut ["+a+"] is deprecated.")})})},remove:function(a){var b=shortcut._format_shortcut_combination(a);Object.values(this._listeners).forEach(function(d,c){Object.values(d).forEach(function(e,g){e.unregister_combo(b)})})},_listeners:{disabled_in_inputs:{},enabled_in_inputs:{}},
_is_sequence_shortcut_triggered:!1,_wrap_shortcut_call:function(a,b){return b===shortcut.type.SEQUENCE?function(d){shortcut._is_sequence_shortcut_triggered=!0;setTimeout(function(){shortcut._is_sequence_shortcut_triggered=!1},500);a.apply(this,[d])}:function(d){shortcut._is_sequence_shortcut_triggered||a.apply(this,[d])}},_get_or_create_listener:function(a,b,d){if(a in b)return b[a];var c=new d.Listener(a);if(b===this._listeners.disabled_in_inputs)jQuery(document).on("focus","input, textarea, [contenteditable=true], .CodeMirror-code",
function(){c.stop_listening()}).on("blur","input, textarea, [contenteditable=true], .CodeMirror-code",function(){c.listen()});return b[a]=c},_format_shortcut_combination:function(a){return a.toLowerCase().replace(/\+/g," ")}});
function BrowserDetect(){var a=navigator.userAgent.toLowerCase();this.isGecko=-1!=a.indexOf("gecko")&&-1==a.indexOf("safari");this.isAppleWebKit=-1!=a.indexOf("applewebkit");this.isKonqueror=-1!=a.indexOf("konqueror");this.isSafari=-1!=a.indexOf("safari");this.isOmniweb=-1!=a.indexOf("omniweb");this.isOpera=-1!=a.indexOf("opera");this.isIcab=-1!=a.indexOf("icab");this.isAol=-1!=a.indexOf("aol");this.isIE=-1!=a.indexOf("msie")&&!this.isOpera&&-1==a.indexOf("webtv");this.isMozilla=this.isGecko&&a.indexOf("gecko/")+
14==a.length;this.isFirefox=-1!=a.indexOf("firefox/")||-1!=a.indexOf("firebird/");this.isNS=this.isGecko?-1!=a.indexOf("netscape"):-1!=a.indexOf("mozilla")&&!this.isOpera&&!this.isSafari&&-1==a.indexOf("spoofer")&&-1==a.indexOf("compatible")&&-1==a.indexOf("webtv")&&-1==a.indexOf("hotjava");this.isIECompatible=-1!=a.indexOf("msie")&&!this.isIE;this.isNSCompatible=-1!=a.indexOf("mozilla")&&!this.isNS&&!this.isMozilla;this.geckoVersion=this.isGecko?a.substring(a.lastIndexOf("gecko/")+6,a.lastIndexOf("gecko/")+
14):-1;this.equivalentMozilla=this.isGecko?parseFloat(a.substring(a.indexOf("rv:")+3)):-1;this.appleWebKitVersion=this.isAppleWebKit?parseFloat(a.substring(a.indexOf("applewebkit/")+12)):-1;this.versionMinor=parseFloat(navigator.appVersion);this.isGecko&&!this.isMozilla?this.versionMinor=parseFloat(a.substring(a.indexOf("/",a.indexOf("gecko/")+6)+1)):this.isMozilla?this.versionMinor=parseFloat(a.substring(a.indexOf("rv:")+3)):this.isIE&&4<=this.versionMinor?this.versionMinor=parseFloat(a.substring(a.indexOf("msie ")+
5)):this.isKonqueror?this.versionMinor=parseFloat(a.substring(a.indexOf("konqueror/")+10)):this.isSafari?this.versionMinor=parseFloat(a.substring(a.lastIndexOf("safari/")+7)):this.isOmniweb?this.versionMinor=parseFloat(a.substring(a.lastIndexOf("omniweb/")+8)):this.isOpera?this.versionMinor=parseFloat(a.substring(a.indexOf("opera")+6)):this.isIcab&&(this.versionMinor=parseFloat(a.substring(a.indexOf("icab")+5)));this.versionMajor=parseInt(this.versionMinor);this.isDOM1=document.getElementById;this.isDOM2Event=
document.addEventListener&&document.removeEventListener;this.mode=document.compatMode?document.compatMode:"BackCompat";this.isWin32=(this.isWin=-1!=a.indexOf("win"))&&(-1!=a.indexOf("95")||-1!=a.indexOf("98")||-1!=a.indexOf("nt")||-1!=a.indexOf("win32")||-1!=a.indexOf("32bit")||-1!=a.indexOf("xp"));this.isMac=-1!=a.indexOf("mac");this.isUnix=-1!=a.indexOf("unix")||-1!=a.indexOf("sunos")||-1!=a.indexOf("bsd")||-1!=a.indexOf("x11");this.isLinux=-1!=a.indexOf("linux");this.isNS40x=(this.isNS4x=this.isNS&&
4==this.versionMajor)&&4.5>this.versionMinor;this.isNS47x=this.isNS4x&&4.7<=this.versionMinor;this.isNS4up=this.isNS&&4<=this.versionMinor;this.isNS6x=this.isNS&&6==this.versionMajor;this.isNS6up=this.isNS&&6<=this.versionMajor;this.isNS7x=this.isNS&&7==this.versionMajor;this.isNS7up=this.isNS&&7<=this.versionMajor;this.isIE4x=this.isIE&&4==this.versionMajor;this.isIE4up=this.isIE&&4<=this.versionMajor;this.isIE5x=this.isIE&&5==this.versionMajor;this.isIE55=this.isIE&&5.5==this.versionMinor;this.isIE5up=
this.isIE&&5<=this.versionMajor;this.isIE6x=this.isIE&&6==this.versionMajor;this.isIE6up=this.isIE&&6<=this.versionMajor;this.isIE4xMac=this.isIE4x&&this.isMac;this.isIE11up=(a=/trident\/(\d+)/.exec(a))&&7<=parseInt(a[1])}var browser=new BrowserDetect;
XWiki.Document=Class.create({initialize:function(a,b,d){"string"===typeof a||"string"===typeof b||"string"===typeof d?this.initializeFromStrings(a,b,d):this.initializeFromReference(a)},initializeFromReference:function(a){this.documentReference=a||XWiki.Document.currentDocumentReference;a=this.documentReference.extractReference(XWiki.EntityType.WIKI);a=this.documentReference.extractReference(XWiki.EntityType.SPACE).relativeTo(a);this.page=this.documentReference.extractReferenceValue(XWiki.EntityType.DOCUMENT);
this.space=XWiki.Model.serialize(a);this.spaces=a.getReversedReferenceChain().map(function(b){return b.getName()});this.wiki=this.documentReference.extractReferenceValue(XWiki.EntityType.WIKI)},initializeFromStrings:function(a,b,d){this.page=a||XWiki.Document.currentPage;this.space=b||XWiki.Document.currentSpace;this.spaces=XWiki.Model.resolve(this.space,XWiki.EntityType.SPACE).getReversedReferenceChain().map(function(c){return c.getName()});this.wiki=d||XWiki.Document.currentWiki;this.documentReference=
new XWiki.DocumentReference(this.wiki,this.spaces,this.page)},getURL:function(a,b,d){a=a||"view";var c="view"==a?XWiki.Document.ViewURLTemplate:XWiki.Document.URLTemplate,e=this.spaces.map(function(g){return encodeURIComponent(g)}).join("/");c=c.replace("__space__",e);c=c.replace("__page__","WebHome"==this.page?"":encodeURIComponent(this.page));c=c.replace("__action__/",encodeURIComponent(a)+"/");b&&(c+="?"+b);d&&(c+="#"+d);return c},getRestURL:function(a,b){a=a||"";var d=XWiki.Document.RestURLTemplate;
d=d.replace("__wiki__",this.wiki);var c=this.spaces.map(function(e){return encodeURIComponent(e)}).join("/spaces/");d=d.replace("__space__",c);d=d.replace("__page__",this.page);a&&(d+="/"+a);b&&(d+="?"+b);return d},getDocumentReference:function(){return this.documentReference}});var htmlElement=$(document.documentElement);
if(null!=htmlElement.readAttribute("data-xwiki-reference")){var documentReference=XWiki.Model.resolve(htmlElement.readAttribute("data-xwiki-reference"),XWiki.EntityType.DOCUMENT),spaceReference=documentReference.extractReference(XWiki.EntityType.SPACE),wikiReference=documentReference.extractReference(XWiki.EntityType.WIKI);XWiki.Document.currentDocumentReference=documentReference;XWiki.Document.currentPage=XWiki.Document.currentDocumentReference.getName();XWiki.Document.currentSpace=XWiki.Model.serialize(spaceReference.relativeTo(wikiReference));
XWiki.Document.currentWiki=wikiReference.getName();XWiki.currentDocument=new XWiki.Document}else XWiki.Document.currentWiki=XWiki.currentWiki||"xwiki",XWiki.Document.currentSpace=XWiki.currentSpace||"Main",XWiki.Document.currentPage=XWiki.currentPage||"WebHome",0<$$("meta[name=wiki]").length&&(XWiki.Document.currentWiki=$$("meta[name=wiki]")[0].content),0<$$("meta[name=space]").length&&(XWiki.Document.currentSpace=$$("meta[name=space]")[0].content),0<$$("meta[name=page]").length&&(XWiki.Document.currentPage=
$$("meta[name=page]")[0].content),XWiki.currentDocument=new XWiki.Document(XWiki.Document.currentPage,XWiki.Document.currentSpace,XWiki.Document.currentWiki),XWiki.Document.currentDocumentReference=XWiki.currentDocument.getDocumentReference();XWiki.Document.URLTemplate="$xwiki.getURL('__space__.__page__', '__action__')";XWiki.Document.ViewURLTemplate="$xwiki.getURL('__space__.__page__')";XWiki.Document.RestURLTemplate="${request.contextPath}/rest/wikis/__wiki__/spaces/__space__/pages/__page__";
XWiki.Document.WikiSearchURLStub="${request.contextPath}/rest/wikis/__wiki__/search";XWiki.Document.SpaceSearchURLStub="${request.contextPath}/rest/wikis/__wiki__/spaces/__space__/search";XWiki.Document.getRestSearchURL=function(a,b,d){d=d||XWiki.Document.currentWiki;b=b?Array.isArray(b)?b:[b]:[];0<b.length?(b=b.join("/spaces/"),d=XWiki.Document.SpaceSearchURLStub.replace("__wiki__",d).replace("__space__",b)):d=XWiki.Document.WikiSearchURLStub.replace("__wiki__",d);a&&(d+="?"+a);return d};
(function(){if("placeholder"in document.createElement("input"))var a=function(c){c=c.memo.element;""===c.placeholder&&(c.hasClassName("useTitleAsTip")?c.placeholder=c.title:(c.placeholder=c.defaultValue,c.value=""))};else{var b=function(){var c=this.hasClassName("empty");this.removeClassName("empty");c?this.value="":this.select()},d=function(){""==this.value&&(this.value=this.defaultValue,this.addClassName("empty"))};a=function(c){c=c.memo.element;var e=c.value;c.readAttribute("placeholder")?c.defaultValue=
c.readAttribute("placeholder"):c.hasClassName("useTitleAsTip")&&(c.defaultValue=c.title);c.value=e;c.value==c.defaultValue&&c.addClassName("empty");c.observe("focus",b.bindAsEventListener(c));c.observe("blur",d.bindAsEventListener(c))}}document.observe("xwiki:addBehavior:withTip",a);document.observe("xwiki:dom:loaded",function(){$$("input.withTip","textarea.withTip","[placeholder]").each(function(c){document.fire("xwiki:addBehavior:withTip",{element:c})})});document.observe("xwiki:dom:updated",function(c){c.memo.elements.each(function(e){e.select("input.withTip",
"textarea.withTip","[placeholder]").each(function(g){document.fire("xwiki:addBehavior:withTip",{element:g})})})})})();
document.observe("xwiki:dom:loaded",function(){var a={documents:{script:XWiki.Document.getRestSearchURL("scope=name&number=10&"),varname:"q",icon:"$xwiki.getSkinFile('icons/silk/page_white_text.png')",noresults:"Document not found",json:!0,resultsParameter:"searchResults",resultId:"id",resultValue:"pageFullName",resultInfo:"pageFullName"},spaces:{script:XWiki.Document.getRestSearchURL("scope=spaces&number=10&"),varname:"q",icon:"$xwiki.getSkinFile('icons/silk/folder.png')",noresults:"Space not found",
json:!0,resultsParameter:"searchResults",resultId:"id",resultValue:"space",resultInfo:"space"},propertyValues:{script:function(d){return["$request.contextPath/rest/wikis",encodeURIComponent(XWiki.currentWiki),"classes",encodeURIComponent(d.getAttribute("data-className")),"properties",encodeURIComponent(d.getAttribute("data-propertyName")),"values"].join("/")},varname:"fp",noresults:"Value not found",json:!0,resultsParameter:"propertyValues",resultId:"value",resultValue:"value",resultInfo:"metaData.label",
minchars:0}},b=function(d){if("undefined"!=typeof XWiki.widgets.Suggest)for(var c=Object.keys(a),e=0;e<c.length;e++){var g="input.suggest"+c[e].substr(0,1).toUpperCase()+c[e].substr(1);d.each(function(f){$(f).select(g).each(function(h){if(!h.hasClassName("initialized")){var k={timeout:3E4};Object.extend(k,a[c[e]]);"function"===typeof k.script&&(k.script=k.script(h));new XWiki.widgets.Suggest(h,k);h.addClassName("initialized")}})})}};b([$(document.documentElement)]);document.observe("xwiki:dom:updated",
function(d){b(d.memo.elements)})});["xwiki:dom:loaded","xwiki:dom:updated"].each(function(a){document.observe(a,function(b){"undefined"!=typeof XWiki.widgets.Suggest&&(b.memo&&b.memo.elements||[document.documentElement]).each(function(d){d.select(".suggested").each(function(c){c.setAttribute("autocomplete","off");"function"===typeof c.onfocus&&(c.onfocus(),c.removeAttribute("onfocus"))})})})});
document.observe("xwiki:dom:loaded",function(){function a(){var f=$$(".annotationsettings"),h=0;f&&0<f.size()&&(e.__fm_extra=f[0],b(e.__fm_extra),h=e.__fm_extra.getHeight());f=e.getHeight();h=g.cumulativeOffset().top-h;if(document.viewport.getScrollOffsets().top>=h){h=g.getWidth();var k=g.cumulativeOffset().left;d(e,0,k,h);e.__fm_extra&&d(e.__fm_extra,f,k,h-e.__fm_extra.getStyle("border-left-width").replace(/[^0-9]/g,"")-e.__fm_extra.getStyle("border-right-width").replace(/[^0-9]/g,"")-e.__fm_extra.getStyle("padding-right").replace(/[^0-9]/g,
"")-e.__fm_extra.getStyle("padding-left").replace(/[^0-9]/g,""))}else c(e),c(e.__fm_extra)}function b(f){"undefined"==typeof f.__fm_ghost&&(f.__fm_ghost=new Element("div"),f.__fm_ghost.hide(),f.insert({after:f.__fm_ghost}));f.__fm_ghost.clonePosition(f,{setWidth:!1})}function d(f,h,k,m){f&&(f.addClassName("floating-menu"),f.style.position="fixed",f.style.top=h+"px",f.style.left=k+"px",f.style.width=m+"px",f.__fm_ghost.show())}function c(f){f&&(f.removeClassName("floating-menu"),f.style.position="",
f.style.top="",f.style.left="",f.style.width="",f.__fm_ghost.hide())}if($("body").hasClassName("skin-colibri")){var e=$("contentmenu")||$("editmenu"),g=$("mainContentArea")||$("mainEditArea");e&&g&&(b(e),Event.observe(window,"resize",function(){if("fixed"==e.style.position&&(e.style.width=g.getWidth()+"px","undefined"!=typeof e.__fm_extra)){if("px"==e.__fm_extra.getStyle("padding-left").replace(/[^a-z]/g,"")){var f=e.__fm_extra.getStyle("border-left-width").replace(/[^0-9.]/g,"")-0;f+=e.__fm_extra.getStyle("padding-left").replace(/[^0-9.]/g,
"")-0;f+=e.__fm_extra.getStyle("padding-right").replace(/[^0-9.]/g,"")-0;f+=e.__fm_extra.getStyle("border-right-width").replace(/[^0-9.]/g,"")-0}else f=50;e.__fm_extra.style.width=g.getWidth()-f+"px"}}),browser.isIE6x||(Event.observe(window,"scroll",a),document.observe("xwiki:annotations:settings:loaded",a)))}});
require(["jquery"],function(a){var b=function(){return a("link[href], script[src]").map(function(){return a(this).attr("href")||a(this).attr("src")}).get()},d=function(e){var g;e=a("<div/>").html(e);e.find("link[href], script[src]").filter(function(){g||(g=b());var f=a(this).attr("href")||a(this).attr("src");return 0<=g.indexOf(f)}).remove();e.contents().appendTo("head")},c=function(e){d(e("X-XWIKI-HTML-HEAD"));setTimeout(function(){d(e("X-XWIKI-HTML-SCRIPTS"))},0)};a(function(){var e=window.XMLHttpRequest.prototype.open;
window.XMLHttpRequest.prototype.open=function(){this.addEventListener("load",function(){c(a.proxy(this,"getResponseHeader"))});return e.apply(this,arguments)}});a(function(){var e=window.fetch;e&&(window.fetch=function(){return e.apply(this,arguments).then(function(g){c(a.proxy(g.headers,"get"))})})})});

//# sourceMappingURL=xwiki.min.js.map
