'use strict';var XWiki=function(a){function d(g,k,l){for(var n=-1;++n<g.length;)for(var u=0;u<k.length;u++){a:{var v=g;for(var A=n,w=k[u],x=0;x<w.length;x++){var y=A+x;if(y>=v.length||v.charAt(y)!=w.charAt(x)){v=!1;break a}}v=!0}if(v){g=g.substr(0,n)+l[u]+g.substr(n+k[u].length);n+=l[u].length-1;break}}return g}var b=0;a.EntityType={WIKI:b++,SPACE:b++,DOCUMENT:b++,ATTACHMENT:b++,OBJECT:b++,OBJECT_PROPERTY:b++,CLASS_PROPERTY:b++};var c=[],e;for(e in a.EntityType)if(a.EntityType.hasOwnProperty(e)){b=
a.EntityType[e];for(var f=e.toLowerCase().split("_"),h=1;h<f.length;h++)f[h]=f[h].substr(0,1).toUpperCase()+f[h].substr(1);c[b]=f.join("")}a.EntityType.getName=function(g){return c[g]};a.EntityType.byName=function(g){g=g.toLowerCase();for(var k=0;k<c.length;k++)if(c[k]===g)return k;return-1};a.EntityReference=Class.create({initialize:function(g,k,l,n){this.name=g;this.type=k;this.parent=l;this.locale=n},extractReference:function(g){for(var k=this;k&&k.type!=g;)k=k.parent;return k},extractReferenceValue:function(g){return(g=
this.extractReference(g))?g.name:null},relativeTo:function(g){var k=this.getReversedReferenceChain();g=g?g.getReversedReferenceChain():[];for(var l,n=l=0;l<k.length&&n<g.length&&k[l].type!=g[n].type;)k[l].type>g[n].type?n++:l++;for(;l<k.length&&n<g.length&&k[l].type===g[n].type&&k[l].name===g[n].name;)l++,n++;if(n<g.length&&0<n&&g[n].type===g[n-1].type&&0<l)for(l--;0<l&&k[l].type===k[l-1].type;l--);for(var u;l<k.length;l++)u=new a.EntityReference(k[l].name,k[l].type,u);return u||new a.EntityReference("",
this.type)},getReversedReferenceChain:function(){for(var g=[],k=this;k;)g.push(k),k=k.parent;return g.reverse()},getRoot:function(){for(var g=this;g.parent;)g=g.parent;return g},appendParent:function(g){this.getRoot().parent=g;return this},hasParent:function(g){var k=this.parent;if(k==g)return!0;for(;k&&!k.equals(g);)k=k.parent;return null!=k},equals:function(g){return null==g||null==this.parent&&null!=g.parent||null!=this.parent&&null==g.parent?!1:this.name===g.name&&this.type===g.type&&(null==this.parent||
this.parent.equals(g.parent))},toString:function(){return a.Model.serialize(this)},getName:function(){return this.name}});a.EntityReference.fromJSONObject=function(g){var k=null!=g.parent?a.EntityReference.fromJSONObject(g.parent):void 0;return new a.EntityReference(g.name,a.EntityType.byName(g.type),k,g.locale)};a.WikiReference=Class.create(a.EntityReference,{initialize:function($super,k){$super(k,a.EntityType.WIKI)}});a.SpaceReference=Class.create(a.EntityReference,{initialize:function($super,k,
l){k=new a.WikiReference(k);if(Array.isArray(l)&&0<l.length){var n;for(n=0;n<l.length-1;++n)k=new a.EntityReference(l[n],a.EntityType.SPACE,k);$super(l[n],a.EntityType.SPACE,k)}else if("string"===typeof l||"undefined"==typeof l)$super(l,a.EntityType.SPACE,k);else throw"Missing mandatory space name or invalid type for: ["+l+"]";}});a.DocumentReference=Class.create(a.EntityReference,{initialize:function($super,k,l,n){$super(n,a.EntityType.DOCUMENT,new a.SpaceReference(k,l))}});a.AttachmentReference=
Class.create(a.EntityReference,{initialize:function($super,k,l){$super(k,a.EntityType.ATTACHMENT,l)}});a.EntityReferenceTreeNode=Class.create({initialize:function(){this.children={};this.locales={}},_fromJSONObject:function(g){null!=g.reference&&(this.reference=a.EntityReference.fromJSONObject(g.reference));g.children.each(this._childFromJSONObject.bind(this));g.locales.each(this._localeFromJSONObject.bind(this))},_childFromJSONObject:function(g){var k=new a.EntityReferenceTreeNode;k._fromJSONObject(g);
g=this.children[k.reference.name];"undefined"==typeof g&&(g={},this.children[k.reference.name]=g);g[k.reference.type]=k},_localeFromJSONObject:function(g){this.locales[g.locale]=a.EntityReference.fromJSONObject(g)},hasChildren:function(){return 0!==Object.keys(this.children).length},hasLocales:function(){return 0!==Object.keys(this.locales).length},getChildByReference:function(g){if("undefined"==typeof g)return null;var k=this;g=g.getReversedReferenceChain();for(var l=0;l<g.length;l++){var n=g[l];
k=k.children[n.name];if("undefined"==typeof k)return null;k=k[n.type];if("undefined"==typeof k)return null}return k}});a.EntityReferenceTree=Class.create(a.EntityReferenceTreeNode,{});a.EntityReferenceTree.fromJSONObject=function(g){var k=new a.EntityReferenceTree;k._fromJSONObject(g);return k};var m=[[],[".",":","\\"],[".","\\"],["@","\\"],["^","\\"],[".","\\"],["^",".","\\"]],p=[[],["\\.","\\:","\\\\"],["\\.","\\\\"],["\\@","\\\\"],["\\^","\\\\"],["\\.","\\\\"],["\\^","\\.","\\\\"]],r=[[],[".",
":"],[".",":"],["@",".",":"],["^",".",":"],[".","^",".",":"],["^",".",":"]],t=[null,a.EntityType.WIKI,a.EntityType.SPACE,a.EntityType.DOCUMENT,a.EntityType.DOCUMENT,a.EntityType.OBJECT,a.EntityType.DOCUMENT],q=[];for(h=1;h<r.length;h++)q[h]={};q[a.EntityType.SPACE][":"]=a.EntityType.WIKI;q[a.EntityType.SPACE]["."]=a.EntityType.SPACE;q[a.EntityType.DOCUMENT]["."]=a.EntityType.SPACE;q[a.EntityType.ATTACHMENT]["@"]=a.EntityType.DOCUMENT;q[a.EntityType.OBJECT]["^"]=a.EntityType.DOCUMENT;q[a.EntityType.OBJECT_PROPERTY]["."]=
a.EntityType.OBJECT;q[a.EntityType.CLASS_PROPERTY]["^"]=a.EntityType.DOCUMENT;var z=["\\\\","\\"],B=["\\",""];a.EntityReferenceResolver=Class.create({resolve:function(g,k,l){g=(g||"").split("");k=parseInt(k);if(isNaN(k)||0>k||k>=r.length)throw"No parsing definition found for Entity Type ["+k+"]";var n=q[k];if(!n)return this._getEscapedReference(g,k,l);do{for(var u=null,v=g.length;0<=--v;){var A=g[v],w=v-1,x=0>w?0:g[w];if("number"===typeof n[A])if(0===this._getNumberOfCharsBefore("\\",g,w)%2){u=n[A];
break}else g.splice(w,1),--v;else"\\"===x&&(g.splice(w,1),--v)}n=this._getNewReference(v,g,k,l);var y=this._appendNewReference(y,n);k=u?u:t[k];n=q[k]}while(null!=n);l=this._getEscapedReference(g,k,l);return y=this._appendNewReference(y,l)},_getEscapedReference:function(g,k,l){return 0<g.length?(g=d(g.join(""),z,B),new a.EntityReference(g,k)):this._resolveDefaultReference(k,l)},_getNewReference:function(g,k,l,n){g<k.length-1?(n=k.slice(g+1).join(""),l=new a.EntityReference(n,l)):l=this._resolveDefaultReference(l,
n);k.splice(Math.max(g,0),k.length);return l},_resolveDefaultReference:function(g,k){var l;if("object"===typeof k)if(k&&"function"===typeof k.extractReference){k=k.extractReference(g);for(l=[];k&&k.type===g;)l.push(k.name),k=k.parent;l.reverse()}else l=k&&k[g];else"function"===typeof k&&(l=k(g));k=null;if(l&&0<l.length){"string"===typeof l&&(l=[l]);for(var n=0;n<l.length;n++)k=new a.EntityReference(l[n],g,k)}return k},_appendNewReference:function(g,k){return k?g?g.appendParent(k):k:g},_getNumberOfCharsBefore:function(g,
k,l){for(var n=l;0<=n&&k[n]===g;)--n;return l-n}});a.EntityReferenceSerializer=Class.create({serialize:function(g){return g?this.serialize(g.parent)+this._serializeComponent(g):""},_serializeComponent:function(g){var k="",l=m[g.type];g.parent&&(k+=g.parent.type===a.EntityType.WIKI?":":l[0]);return k=0<l.length?k+d(g.name,l,p[g.type]):k+g.name.replace("\\","\\\\")}});var C=new a.EntityReferenceResolver,D=new a.EntityReferenceSerializer;a.Model={serialize:function(g){return D.serialize(g)},resolve:function(g,
k,l){if(void 0==k&&"string"===typeof g){var n=g.indexOf(":");0<n&&(k=a.EntityType.byName(g.substring(0,n)),0<=k&&(g=g.substring(n+1)))}return C.resolve(g,k,l)}};return a}(XWiki||{});
XWiki=function(a){a.widgets=a.widgets||{};Object.extend(a,{constants:{anchorSeparator:"#",docextraCommentsAnchor:"Comments",docextraAttachmentsAnchor:"Attachments",docextraHistoryAnchor:"History",docextraInformationAnchor:"Information"},resource:{get:function(d,b){for(var c="",e=["Attachments"],f=[a.EntityType.DOCUMENT],h=0;h<e.length;h++)if(d.endsWith(a.constants.anchorSeparator+e[h])){c=e[h];d=d.substr(0,d.length-(c.length+1));b=b||f[h];break}b?b=a.Model.resolve(d,b):(b=a.Model.resolve(d,a.EntityType.ATTACHMENT),
b.parent||(b=a.Model.resolve(d,a.EntityType.DOCUMENT),b.parent||(d=a.Model.resolve(d,a.EntityType.SPACE),d.parent&&(b=d))));return this.fromEntityReference(b,c)},fromEntityReference:function(d,b){var c=d.extractReference(a.EntityType.WIKI);c=c&&c.name||a.currentWiki;var e=d.extractReference(a.EntityType.SPACE);e=e&&e.name||a.currentSpace;var f=d.extractReference(a.EntityType.DOCUMENT);f=f&&f.name||a.currentPage;d=(d=d.extractReference(a.EntityType.ATTACHMENT))&&d.name||"";var h=new a.DocumentReference(c,
e,f),m=a.Model.serialize(h.relativeTo(new a.WikiReference(c))),p=a.Model.serialize(h.parent);h=a.Model.serialize(h);return{wiki:c,space:e,prefixedSpace:p,fullName:m,prefixedFullName:h,name:f,attachment:d,anchor:b}},asEntityReference:function(d){var b;d=[d.wiki,d.space,d.name,d.attachment];for(var c=0;c<d.length;c++)d[c]&&(b=new a.EntityReference(d[c],c,b));return b},serialize:function(d){var b=a.Model.serialize(this.asEntityReference(d));d.anchor&&(0<b.length&&(b+=a.constants.anchorSeparator),b+=
d.anchor);return b}},getResource:function(d){return this.resource.get(d)},displayDocExtra:function(d,b,c){var e=function(m){var p=document.getElementById(m+"tab"),r=document.getElementById(m+"pane");null!=window.activeDocExtraTab&&(window.activeDocExtraTab.className="",window.activeDocExtraPane.className="hidden");window.activeDocExtraTab=p;window.activeDocExtraPane=r;window.activeDocExtraTab.className="active";window.activeDocExtraPane.className="";p.blur();document.fire("xwiki:docextra:activated",
{id:m})};if(-1!=$(d+"pane").className.indexOf("empty")){null!=window.activeDocExtraPane&&(window.activeDocExtraPane.className="invisible");$("docextrapanes").className="loading";var f="",h=window.location.search.toQueryParams().minify;h&&"false"==h&&(f="&minify=false");new Ajax.Request(window.docgeturl+"?xpage=xpart&vm="+b+f,{method:"get",onSuccess:function(m){var p=document.body.previous("head");m=m.responseText;var r=new Element("div");r.innerHTML=m;r.select("link").each(function(q){0==p.select('link[href="'+
q.readAttribute("href")+'"][type="'+q.readAttribute("type")+'"]').length&&p.insert(new Element("link",{rel:"stylesheet",type:q.type,href:q.readAttribute("href")}));q.remove()});r.select("script").each(function(q){q.src&&0==p.select('script[src="'+q.readAttribute("src")+'"][type="'+q.readAttribute("type")+'"]').length&&p.insert(new Element("script",{type:q.type,src:q.readAttribute("src")}))});var t=$(d+"pane");r.childElements().forEach(function(q){t.insert(q)});document.fire("xwiki:dom:updated",{elements:[$(d+
"pane")]})},onComplete:function(m){401==m.status&&document.location.reload();$("docextrapanes").className="";document.fire("xwiki:docextra:loaded",{id:d,element:$(d+"pane")});e(d);c&&($(d+"anchor").id=d,location.href="#"+d,$(d).id=d+"anchor")}})}else e(d),c&&($(d+"anchor").id=d,location.href="#"+d,$(d).id=d+"anchor")},makeRenderingErrorsExpandable:function(d){$(d||"body").select(".xwikirenderingerror").each(function(b){""!==b.next().innerHTML&&b.next().hasClassName("xwikirenderingerrordescription")&&
(b.style.cursor="pointer",b.title="$escapetool.javascript($services.localization.render('platform.core.rendering.error.readTechnicalInformation'))",Event.observe(b,"click",function(c){c.element().next().toggleClassName("hidden")}))})},fixLinksTargetAttribute:function(d){d=$(d||"body").select("a[rel]");for(var b=0;b<d.length;b++){var c=d[b];if(!c.up(".xRichTextEditor")&&c.getAttribute("href")&&c.getAttribute("rel")){for(var e=c.getAttribute("rel").split(" "),f=0;f<e.length;f++)if("_"==e[f].charAt(0)){c.target=
e[f].substring(1);break}else if("external"==e[f]){c.target="_blank";break}c.target&&"_self"!=c.target&&"_parent"!=c.target&&"_top"!=c.target&&(f=function(h,m){for(var p=0;p<h.length;++p)if(h[p]==m)return!0;return!1},f(e,"noopener")||e.push("noopener"),f(e,"noreferrer")||e.push("noreferrer"),c.setAttribute("rel",e.join(" ")))}}},insertSectionEditLinks:function(d){if($xwiki.hasSectionEdit()&&"xwiki/1.0"!=a.docsyntax&&"view"==a.contextaction&&a.hasEdit){var b=1;d=$(d||"body");if(d="xwikicontent"==d.id?
d:d.down("#xwikicontent")){d=d.childNodes;for(var c=new RegExp("H[1-"+$xwiki.getSectionEditingDepth()+"]"),e=0;e<d.length;e++){var f=$(d[e]);if(c.test(f.nodeName)&&!f.classList.contains("wikigeneratedheader")&&!f.down("a.edit_section")){var h=document.createElement("a");h.className="edit_section";h.toggle(f.visible()&&!f.hasClassName("hidden"));h.setAttribute("role","button");h.title=$jsontool.serialize($services.localization.render("edit"));h.innerHTML=$jsontool.serialize($services.icon.renderHTML("pencil"));
var m=document.createElement("span");m.className="sr-only";m.textContent=$jsontool.serialize($services.localization.render("edit"));h.appendChild(m);a.hasRenderer?h.href=window.docediturl+"?section="+b:(h.className+=" disabled",h.setAttribute("aria-disabled","true"),h.setAttribute("tabindex","-1"),h.title=$jsontool.serialize($services.localization.render("platform.core.rendering.noRendererForSectionEdit")),h.href="#"+(f.id||""));f.appendChild(h);b++}}}}},insertCreatePageFromTemplateModalBoxes:function(d){if("xwiki/1.0"!=
a.docsyntax&&"view"==a.contextaction&&a.hasEdit&&a.widgets.ModalPopup){a.widgets.CreatePagePopup=Class.create(a.widgets.ModalPopup,{initialize:function($super,e){var f=new Element("div",{"class":"modal-popup"});f.insert(e.content);$super(f,{show:{method:this.showDialog,keys:[]},close:{method:this.closeDialog,keys:["Esc"]}},{displayCloseButton:!0,verticalPosition:"center",backgroundColor:"#FFF"});this.showDialog();this.setClass("createpage-modal-popup")}});d=$(d||"body").select("span.wikicreatelink:not(.skipCreatePagePopup)");
for(var b=0;b<d.length;b++)d[b].down("a").observe("click",function(c){new Ajax.Request(c.findElement("a").href.replace(/#.*$/,""),{method:"get",parameters:{xpage:"createinline",ajax:1},onSuccess:function(e){var f=e.getHeader("redirect");if(f)window.location=f;else{var h=new a.widgets.Notification("$escapetool.javascript($services.localization.render('core.create.popup.loading'))","inprogress");f=new Element("link",{rel:"stylesheet",type:"text/css",href:'$xwiki.getSkinFile("uicomponents/widgets/select/select.css", true)'});
$(document.head).insert(f);require(["$xwiki.getSkinFile('js/xwiki/create.js', true)","$xwiki.getSkinFile('uicomponents/widgets/select/select.js', true)"],function(m){new a.widgets.CreatePagePopup({content:e.responseText});h.hide()})}},onFailure:function(){(new a.widgets.Notification("$escapetool.javascript($services.localization.render('core.create.ajax.error'))","error",{inactive:!0})).show()}});c.stop()})}},watchlist:{actionsMap:{tmWatchDocument:"adddocument",tmUnwatchDocument:"removedocument",
tmWatchSpace:"addspace",tmUnwatchSpace:"removespace",tmWatchWiki:"addwiki",tmUnwatchWiki:"removewiki"},flowMap:{tmWatchDocument:"tmUnwatchDocument",tmUnwatchDocument:"tmWatchDocument",tmWatchSpace:"tmUnwatchSpace",tmUnwatchSpace:"tmWatchSpace",tmWatchWiki:"tmUnwatchWiki",tmUnwatchWiki:"tmWatchWiki"},executeAction:function(d){new Ajax.Request(window.docgeturl+"?xpage=watch&do="+this.actionsMap[d.id],{method:"get",onComplete:function(){"A"==d.nodeName?(d.up().toggleClassName("hidden"),$(a.watchlist.flowMap[d.id]).up().toggleClassName("hidden")):
(d.toggleClassName("hidden"),$(a.watchlist.flowMap[d.id]).toggleClassName("hidden"))}})},initialize:function(d){d=$(d||"body");for(var b in a.watchlist.actionsMap){var c=d.down("#"+b);if(c){"A"!=c.nodeName&&(c=$(b).down("A"));if(!c)break;c.stopObserving("click");c.observe("click",function(e){Event.stop(e);for(e=e.element();""==e.id;)e=e.up();a.watchlist.executeAction(e)})}}}},cookies:{create:function(d,b,c){if(c){var e=new Date;e.setTime(e.getTime()+864E5*c);c="; expires="+e.toGMTString()}else c=
"";document.cookie=d+"="+encodeURIComponent(b)+c+"; path=/"},read:function(d){d+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var e=b[c];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(d))return decodeURIComponent(e.substring(d.length,e.length))}return null},erase:function(d){a.cookies.create(d,"",-1)}},togglePanelVisibility:function(d){d=$(d);d.toggleClassName("collapsed")},registerPanelToggle:function(d){$(d||"body").select(".panel .xwikipaneltitle").each(function(b){b.observe("click",
this.togglePanelVisibility.bind(this,b.up(".panel")))}.bind(this))},extractFileName:function(d){d=$(d);if(d.files&&0<d.files.length)return d.files[0].name;if("C:\\fakepath\\"==d.value.substr(0,12))return d.value.substr(12);var b=d.value.lastIndexOf("/");if(0<=b)return d.value.substr(b+1);b=d.value.lastIndexOf("\\");return 0<=b?d.value.substr(b+1):d.value},initialize:function(){if("undefined"==typeof this.isInitialized||0==this.isInitialized)"undefined"==typeof a.lastScriptLoaded?a.failedInit=!0:(this.isInitialized=
!0,document.fire("xwiki:dom:loading"),document.observe("xwiki:dom:updated",function(d){d.memo.elements.each(this._addBehaviour.bind(this))}.bindAsEventListener(this)),this._addBehaviour(),this.domIsLoaded=!0,document.fire("xwiki:dom:loaded"))},_addBehaviour:function(d){d=d||$("body");this.makeRenderingErrorsExpandable(d);this.fixLinksTargetAttribute(d);this.insertSectionEditLinks(d);this.insertCreatePageFromTemplateModalBoxes(d);this.watchlist.initialize(d);this.registerPanelToggle(d)}});return a}(XWiki||
{});document.observe("dom:loaded",XWiki.initialize.bind(XWiki));function showsubmenu(a){if("span"==a.lastChild.tagName.toLowerCase()){window.hidetimer&&(window.hideelement==a.lastChild?(clearTimeout(window.hidetimer),window.hidetimer=null,window.hideelement=null):doHide());var d=Element.positionedOffset(a);a.lastChild.style.left=d[0]-10+"px";a.lastChild.style.top=d[1]+a.offsetHeight+"px";a.lastChild.className=a.lastChild.className.replace("hidden","visible")}}
function hidesubmenu(a){"span"==a.lastChild.tagName.toLowerCase()&&(window.hideelement=a.lastChild,window.hidetimer=setTimeout(doHide,100))}function doHide(){window.hideelement.className=window.hideelement.className.replace("visible","hidden");clearTimeout(window.hidetimer);window.hidetimer=null;window.hideelement=null}function toggleClass(a,d){eltHasClass(a,d)?rmClass(a,d):a.className+=" "+d}function addClass(a,d){eltHasClass(a,d)||(a.className+=" "+d)}
function eltHasClass(a,d){return a.className?(new RegExp("\\b"+d+"\\b")).test(a.className):!1}function rmClass(a,d){a.className=a.className.replace(new RegExp("\\s*\\b"+d+"\\b"),"")}function openURL(a){(win=open(a,"win","titlebar=0,width=990,height=500,resizable,scrollbars"))&&win.focus()}
function openHelp(){(win=open("http://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/XWikiSyntax/WebHome?xpage=print","XWikiSyntax","titlebar=0,width=750,height=480,resizable,scrollbars"))&&win.focus()}function updateName(a,d,b){var c=a.value;c=noaccent(c);0!=b&&(c=c.replace(/class$/gi,""));null==d?a.value=c:d.value=c;return""==c?!1:!0}
function noaccent(a){a=a.replace(/[\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u0100\u0102\u0104\u01cd\u01de\u01e0\u01fa\u0200\u0202\u0226]/g,"A");a=a.replace(/[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0101\u0103\u0105\u01ce\u01df\u01e1\u01fb\u0201\u0203\u0227]/g,"a");a=a.replace(/[\u00c6\u01e2\u01fc]/g,"AE");a=a.replace(/[\u00e6\u01e3\u01fd]/g,"ae");a=a.replace(/[\u008c\u0152]/g,"OE");a=a.replace(/[\u009c\u0153]/g,"oe");a=a.replace(/[\u00c7\u0106\u0108\u010a\u010c]/g,"C");a=a.replace(/[\u00e7\u0107\u0109\u010b\u010d]/g,
"c");a=a.replace(/[\u00d0\u010e\u0110]/g,"D");a=a.replace(/[\u00f0\u010f\u0111]/g,"d");a=a.replace(/[\u00c8\u00c9\u00ca\u00cb\u0112\u0114\u0116\u0118\u011a\u0204\u0206\u0228]/g,"E");a=a.replace(/[\u00e8\u00e9\u00ea\u00eb\u0113\u0115\u0117\u0119\u011b\u01dd\u0205\u0207\u0229]/g,"e");a=a.replace(/[\u011c\u011e\u0120\u0122\u01e4\u01e6\u01f4]/g,"G");a=a.replace(/[\u011d\u011f\u0121\u0123\u01e5\u01e7\u01f5]/g,"g");a=a.replace(/[\u0124\u0126\u021e]/g,"H");a=a.replace(/[\u0125\u0127\u021f]/g,"h");a=a.replace(/[\u00cc\u00cd\u00ce\u00cf\u0128\u012a\u012c\u012e\u0130\u01cf\u0208\u020a]/g,
"I");a=a.replace(/[\u00ec\u00ed\u00ee\u00ef\u0129\u012b\u012d\u012f\u0131\u01d0\u0209\u020b]/g,"i");a=a.replace(/[\u0132]/g,"IJ");a=a.replace(/[\u0133]/g,"ij");a=a.replace(/[\u0134]/g,"J");a=a.replace(/[\u0135]/g,"j");a=a.replace(/[\u0136\u01e8]/g,"K");a=a.replace(/[\u0137\u0138\u01e9]/g,"k");a=a.replace(/[\u0139\u013b\u013d\u013f\u0141]/g,"L");a=a.replace(/[\u013a\u013c\u013e\u0140\u0142\u0234]/g,"l");a=a.replace(/[\u00d1\u0143\u0145\u0147\u014a\u01f8]/g,"N");a=a.replace(/[\u00f1\u0144\u0146\u0148\u0149\u014b\u01f9\u0235]/g,
"n");a=a.replace(/[\u00d2\u00d3\u00d4\u00d5\u00d6\u00d8\u014c\u014e\u0150\u01d1\u01ea\u01ec\u01fe\u020c\u020e\u022a\u022c\u022e\u0230]/g,"O");a=a.replace(/[\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014d\u014f\u0151\u01d2\u01eb\u01ed\u01ff\u020d\u020f\u022b\u022d\u022f\u0231]/g,"o");a=a.replace(/[\u0156\u0158\u0210\u0212]/g,"R");a=a.replace(/[\u0157\u0159\u0211\u0213]/g,"r");a=a.replace(/[\u015a\u015c\u015e\u0160\u0218]/g,"S");a=a.replace(/[\u015b\u015d\u015f\u0161\u0219]/g,"s");a=a.replace(/[\u00de\u0162\u0164\u0166\u021a]/g,
"T");a=a.replace(/[\u00fe\u0163\u0165\u0167\u021b\u0236]/g,"t");a=a.replace(/[\u00d9\u00da\u00db\u00dc\u0168\u016a\u016c\u016e\u0170\u0172\u01d3\u01d5\u01d7\u01d9\u01db\u0214\u0216]/g,"U");a=a.replace(/[\u00f9\u00fa\u00fb\u00fc\u0169\u016b\u016d\u016f\u0171\u0173\u01d4\u01d6\u01d8\u01da\u01dc\u0215\u0217]/g,"u");a=a.replace(/[\u0174]/g,"W");a=a.replace(/[\u0175]/g,"w");a=a.replace(/[\u00dd\u0176\u0178\u0232]/g,"Y");a=a.replace(/[\u00fd\u00ff\u0177\u0233]/g,"y");a=a.replace(/[\u0179\u017b\u017d]/g,
"Z");a=a.replace(/[\u017a\u017c\u017e]/g,"z");a=a.replace(/[\u00df]/g,"SS");return a=a.replace(/[^a-zA-Z0-9_]/g,"")}function prepareName(a){var d=a.register_first_name.value,b=a.register_last_name.value;a=a.xwikiname;""!=d&&(d=d.substring(0,1).toUpperCase()+d.substring(1));""!=b&&(b=b.substring(0,1).toUpperCase()+b.substring(1));""==a.value&&(a.value=noaccent(d+b))}
function checkAdvancedContent(a){result=!1;if(!document.forms.edit)return!0;data=document.forms.edit.content.value;myRE=/<\/?(html|body|img|a|i|b|embed|script|form|input|textarea|object|font|li|ul|ol|table|center|hr|br|p) ?([^>]*)>/ig;(results=data.match(myRE))&&0<results.length&&(result=!0);myRE2=/(#(set|include|if|end|for)|#(#) Advanced content|public class|\/* Advanced content *\/)/ig;(results=data.match(myRE2))&&0<results.length&&(result=!0);return 1==result?confirm(a):!0}
window.shortcut=Object({all_shortcuts:function(){var a=[];Object.values(this._listeners).forEach(function(d,b){Object.values(d).forEach(function(c,e){a=a.concat(c.get_registered_combos())})});return a},type:Object({SIMPLE:"simple",COUNTING:"counting",SEQUENCE:"sequence"}),add:function(a,d,b){require(["$services.webjars.url('org.webjars:Keypress', 'keypress.min.js')","jquery"],function(c){b=b?b:{};var e={keys:shortcut._format_shortcut_combination(a),is_solitary:!0};c=shortcut._get_or_create_listener("target"in
b?b.target:document,"disable_in_input"in b&&b.disable_in_input?shortcut._listeners.disabled_in_inputs:shortcut._listeners.enabled_in_inputs,c);if("type"in b&&-1<Object.values(shortcut.type).indexOf(b.type)){switch(b.type){case shortcut.type.COUNTING:e.is_counting=!0;e.is_unordered=!1;break;case shortcut.type.SEQUENCE:e.is_sequence=!0,e.is_exclusive=!0}e.on_keydown=shortcut._wrap_shortcut_call(d,b.type)}else"type"in b&&console.warn("The parameter ["+b.type+"] for the shortcut ["+a+"] type deprecated."),
e.on_keydown=shortcut._wrap_shortcut_call(d,shortcut.type.SIMPLE);c.register_combo(e);var f=["target","disable_in_input","type"];Object.keys(b).forEach(function(h){-1===f.indexOf(h)&&console.warn("The parameter ["+h+"] for the shortcut ["+a+"] is deprecated.")})})},remove:function(a){var d=shortcut._format_shortcut_combination(a);Object.values(this._listeners).forEach(function(b,c){Object.values(b).forEach(function(e,f){e.unregister_combo(d)})})},_listeners:{disabled_in_inputs:{},enabled_in_inputs:{}},
_is_sequence_shortcut_triggered:!1,_wrap_shortcut_call:function(a,d){return d===shortcut.type.SEQUENCE?function(b){shortcut._is_sequence_shortcut_triggered=!0;setTimeout(function(){shortcut._is_sequence_shortcut_triggered=!1},500);a.apply(this,[b])}:function(b){shortcut._is_sequence_shortcut_triggered||a.apply(this,[b])}},_get_or_create_listener:function(a,d,b){if(a in d)return d[a];var c=new b.Listener(a);if(d===this._listeners.disabled_in_inputs)jQuery(document).on("focus","input, textarea, [contenteditable=true], .CodeMirror-code",
function(){c.stop_listening()}).on("blur","input, textarea, [contenteditable=true], .CodeMirror-code",function(){c.listen()});return d[a]=c},_format_shortcut_combination:function(a){return a.toLowerCase().replace(/\+/g," ")}});
function BrowserDetect(){var a=navigator.userAgent.toLowerCase();this.isGecko=-1!=a.indexOf("gecko")&&-1==a.indexOf("safari");this.isAppleWebKit=-1!=a.indexOf("applewebkit");this.isKonqueror=-1!=a.indexOf("konqueror");this.isSafari=-1!=a.indexOf("safari");this.isOmniweb=-1!=a.indexOf("omniweb");this.isOpera=-1!=a.indexOf("opera");this.isIcab=-1!=a.indexOf("icab");this.isAol=-1!=a.indexOf("aol");this.isIE=-1!=a.indexOf("msie")&&!this.isOpera&&-1==a.indexOf("webtv");this.isMozilla=this.isGecko&&a.indexOf("gecko/")+
14==a.length;this.isFirefox=-1!=a.indexOf("firefox/")||-1!=a.indexOf("firebird/");this.isNS=this.isGecko?-1!=a.indexOf("netscape"):-1!=a.indexOf("mozilla")&&!this.isOpera&&!this.isSafari&&-1==a.indexOf("spoofer")&&-1==a.indexOf("compatible")&&-1==a.indexOf("webtv")&&-1==a.indexOf("hotjava");this.isIECompatible=-1!=a.indexOf("msie")&&!this.isIE;this.isNSCompatible=-1!=a.indexOf("mozilla")&&!this.isNS&&!this.isMozilla;this.geckoVersion=this.isGecko?a.substring(a.lastIndexOf("gecko/")+6,a.lastIndexOf("gecko/")+
14):-1;this.equivalentMozilla=this.isGecko?parseFloat(a.substring(a.indexOf("rv:")+3)):-1;this.appleWebKitVersion=this.isAppleWebKit?parseFloat(a.substring(a.indexOf("applewebkit/")+12)):-1;this.versionMinor=parseFloat(navigator.appVersion);this.isGecko&&!this.isMozilla?this.versionMinor=parseFloat(a.substring(a.indexOf("/",a.indexOf("gecko/")+6)+1)):this.isMozilla?this.versionMinor=parseFloat(a.substring(a.indexOf("rv:")+3)):this.isIE&&4<=this.versionMinor?this.versionMinor=parseFloat(a.substring(a.indexOf("msie ")+
5)):this.isKonqueror?this.versionMinor=parseFloat(a.substring(a.indexOf("konqueror/")+10)):this.isSafari?this.versionMinor=parseFloat(a.substring(a.lastIndexOf("safari/")+7)):this.isOmniweb?this.versionMinor=parseFloat(a.substring(a.lastIndexOf("omniweb/")+8)):this.isOpera?this.versionMinor=parseFloat(a.substring(a.indexOf("opera")+6)):this.isIcab&&(this.versionMinor=parseFloat(a.substring(a.indexOf("icab")+5)));this.versionMajor=parseInt(this.versionMinor);this.isDOM1=document.getElementById;this.isDOM2Event=
document.addEventListener&&document.removeEventListener;this.mode=document.compatMode?document.compatMode:"BackCompat";this.isWin32=(this.isWin=-1!=a.indexOf("win"))&&(-1!=a.indexOf("95")||-1!=a.indexOf("98")||-1!=a.indexOf("nt")||-1!=a.indexOf("win32")||-1!=a.indexOf("32bit")||-1!=a.indexOf("xp"));this.isMac=-1!=a.indexOf("mac");this.isUnix=-1!=a.indexOf("unix")||-1!=a.indexOf("sunos")||-1!=a.indexOf("bsd")||-1!=a.indexOf("x11");this.isLinux=-1!=a.indexOf("linux");this.isNS40x=(this.isNS4x=this.isNS&&
4==this.versionMajor)&&4.5>this.versionMinor;this.isNS47x=this.isNS4x&&4.7<=this.versionMinor;this.isNS4up=this.isNS&&4<=this.versionMinor;this.isNS6x=this.isNS&&6==this.versionMajor;this.isNS6up=this.isNS&&6<=this.versionMajor;this.isNS7x=this.isNS&&7==this.versionMajor;this.isNS7up=this.isNS&&7<=this.versionMajor;this.isIE4x=this.isIE&&4==this.versionMajor;this.isIE4up=this.isIE&&4<=this.versionMajor;this.isIE5x=this.isIE&&5==this.versionMajor;this.isIE55=this.isIE&&5.5==this.versionMinor;this.isIE5up=
this.isIE&&5<=this.versionMajor;this.isIE6x=this.isIE&&6==this.versionMajor;this.isIE6up=this.isIE&&6<=this.versionMajor;this.isIE4xMac=this.isIE4x&&this.isMac;this.isIE11up=(a=/trident\/(\d+)/.exec(a))&&7<=parseInt(a[1])}var browser=new BrowserDetect;
XWiki.Document=Class.create({initialize:function(a,d,b){"string"===typeof a||"string"===typeof d||"string"===typeof b?this.initializeFromStrings(a,d,b):this.initializeFromReference(a)},initializeFromReference:function(a){this.documentReference=a||XWiki.Document.currentDocumentReference;a=this.documentReference.extractReference(XWiki.EntityType.WIKI);a=this.documentReference.extractReference(XWiki.EntityType.SPACE).relativeTo(a);this.page=this.documentReference.extractReferenceValue(XWiki.EntityType.DOCUMENT);
this.space=XWiki.Model.serialize(a);this.spaces=a.getReversedReferenceChain().map(function(d){return d.getName()});this.wiki=this.documentReference.extractReferenceValue(XWiki.EntityType.WIKI)},initializeFromStrings:function(a,d,b){this.page=a||XWiki.Document.currentPage;this.space=d||XWiki.Document.currentSpace;this.spaces=XWiki.Model.resolve(this.space,XWiki.EntityType.SPACE).getReversedReferenceChain().map(function(c){return c.getName()});this.wiki=b||XWiki.Document.currentWiki;this.documentReference=
new XWiki.DocumentReference(this.wiki,this.spaces,this.page)},getURL:function(a,d,b){a=a||"view";var c="view"==a?XWiki.Document.ViewURLTemplate:XWiki.Document.URLTemplate,e=this.spaces.map(function(f){return encodeURIComponent(f)}).join("/");c=c.replace("__space__",e);c=c.replace("__page__","WebHome"==this.page?"":encodeURIComponent(this.page));c=c.replace("__action__/",encodeURIComponent(a)+"/");d&&(c+="?"+d);b&&(c+="#"+b);return c},getRestURL:function(a,d){a=a||"";var b=XWiki.Document.RestURLTemplate;
b=b.replace("__wiki__",this.wiki);var c=this.spaces.map(function(e){return encodeURIComponent(e)}).join("/spaces/");b=b.replace("__space__",c);b=b.replace("__page__",this.page);a&&(b+="/"+a);d&&(b+="?"+d);return b},getDocumentReference:function(){return this.documentReference}});var htmlElement=$(document.documentElement);
if(null!=htmlElement.readAttribute("data-xwiki-reference")){var documentReference=XWiki.Model.resolve(htmlElement.readAttribute("data-xwiki-reference"),XWiki.EntityType.DOCUMENT),spaceReference=documentReference.extractReference(XWiki.EntityType.SPACE),wikiReference=documentReference.extractReference(XWiki.EntityType.WIKI);XWiki.Document.currentDocumentReference=documentReference;XWiki.Document.currentPage=XWiki.Document.currentDocumentReference.getName();XWiki.Document.currentSpace=XWiki.Model.serialize(spaceReference.relativeTo(wikiReference));
XWiki.Document.currentWiki=wikiReference.getName();XWiki.currentDocument=new XWiki.Document}else XWiki.Document.currentWiki=XWiki.currentWiki||"xwiki",XWiki.Document.currentSpace=XWiki.currentSpace||"Main",XWiki.Document.currentPage=XWiki.currentPage||"WebHome",0<$$("meta[name=wiki]").length&&(XWiki.Document.currentWiki=$$("meta[name=wiki]")[0].content),0<$$("meta[name=space]").length&&(XWiki.Document.currentSpace=$$("meta[name=space]")[0].content),0<$$("meta[name=page]").length&&(XWiki.Document.currentPage=
$$("meta[name=page]")[0].content),XWiki.currentDocument=new XWiki.Document(XWiki.Document.currentPage,XWiki.Document.currentSpace,XWiki.Document.currentWiki),XWiki.Document.currentDocumentReference=XWiki.currentDocument.getDocumentReference();XWiki.Document.URLTemplate="$xwiki.getURL('__space__.__page__', '__action__')";XWiki.Document.ViewURLTemplate="$xwiki.getURL('__space__.__page__')";XWiki.Document.RestURLTemplate="${request.contextPath}/rest/wikis/__wiki__/spaces/__space__/pages/__page__";
XWiki.Document.WikiSearchURLStub="${request.contextPath}/rest/wikis/__wiki__/search";XWiki.Document.SpaceSearchURLStub="${request.contextPath}/rest/wikis/__wiki__/spaces/__space__/search";XWiki.Document.getRestSearchURL=function(a,d,b){b=b||XWiki.Document.currentWiki;d=d?Array.isArray(d)?d:[d]:[];0<d.length?(d=d.join("/spaces/"),b=XWiki.Document.SpaceSearchURLStub.replace("__wiki__",b).replace("__space__",d)):b=XWiki.Document.WikiSearchURLStub.replace("__wiki__",b);a&&(b+="?"+a);return b};
(function(){if("placeholder"in document.createElement("input"))var a=function(c){c=c.memo.element;""===c.placeholder&&(c.hasClassName("useTitleAsTip")?c.placeholder=c.title:(c.placeholder=c.defaultValue,c.value=""))};else{var d=function(){var c=this.hasClassName("empty");this.removeClassName("empty");c?this.value="":this.select()},b=function(){""==this.value&&(this.value=this.defaultValue,this.addClassName("empty"))};a=function(c){c=c.memo.element;var e=c.value;c.readAttribute("placeholder")?c.defaultValue=
c.readAttribute("placeholder"):c.hasClassName("useTitleAsTip")&&(c.defaultValue=c.title);c.value=e;c.value==c.defaultValue&&c.addClassName("empty");c.observe("focus",d.bindAsEventListener(c));c.observe("blur",b.bindAsEventListener(c))}}document.observe("xwiki:addBehavior:withTip",a);document.observe("xwiki:dom:loaded",function(){$$("input.withTip","textarea.withTip","[placeholder]").each(function(c){document.fire("xwiki:addBehavior:withTip",{element:c})})});document.observe("xwiki:dom:updated",function(c){c.memo.elements.each(function(e){e.select("input.withTip",
"textarea.withTip","[placeholder]").each(function(f){document.fire("xwiki:addBehavior:withTip",{element:f})})})})})();
document.observe("xwiki:dom:loaded",function(){var a={documents:{script:XWiki.Document.getRestSearchURL("scope=name&number=10&"),varname:"q",icon:"$xwiki.getSkinFile('icons/silk/page_white_text.png')",noresults:"Document not found",json:!0,resultsParameter:"searchResults",resultId:"id",resultValue:"pageFullName",resultInfo:"pageFullName"},spaces:{script:XWiki.Document.getRestSearchURL("scope=spaces&number=10&"),varname:"q",icon:"$xwiki.getSkinFile('icons/silk/folder.png')",noresults:"Space not found",
json:!0,resultsParameter:"searchResults",resultId:"id",resultValue:"space",resultInfo:"space"},propertyValues:{script:function(b){return["$request.contextPath/rest/wikis",encodeURIComponent(XWiki.currentWiki),"classes",encodeURIComponent(b.getAttribute("data-className")),"properties",encodeURIComponent(b.getAttribute("data-propertyName")),"values"].join("/")},varname:"fp",noresults:"Value not found",json:!0,resultsParameter:"propertyValues",resultId:"value",resultValue:"value",resultInfo:"metaData.label",
minchars:0}},d=function(b){if("undefined"!=typeof XWiki.widgets.Suggest)for(var c=Object.keys(a),e=0;e<c.length;e++){var f="input.suggest"+c[e].substr(0,1).toUpperCase()+c[e].substr(1);b.each(function(h){$(h).select(f).each(function(m){if(!m.hasClassName("initialized")){var p={timeout:3E4};Object.extend(p,a[c[e]]);"function"===typeof p.script&&(p.script=p.script(m));new XWiki.widgets.Suggest(m,p);m.addClassName("initialized")}})})}};d([$(document.documentElement)]);document.observe("xwiki:dom:updated",
function(b){d(b.memo.elements)})});["xwiki:dom:loaded","xwiki:dom:updated"].each(function(a){document.observe(a,function(d){"undefined"!=typeof XWiki.widgets.Suggest&&(d.memo&&d.memo.elements||[document.documentElement]).each(function(b){b.select(".suggested").each(function(c){c.setAttribute("autocomplete","off");"function"===typeof c.onfocus&&(c.onfocus(),c.removeAttribute("onfocus"))})})})});
document.observe("xwiki:dom:loaded",function(){function a(){var h=$$(".annotationsettings"),m=0;h&&0<h.size()&&(e.__fm_extra=h[0],d(e.__fm_extra),m=e.__fm_extra.getHeight());h=e.getHeight();m=f.cumulativeOffset().top-m;if(document.viewport.getScrollOffsets().top>=m){m=f.getWidth();var p=f.cumulativeOffset().left;b(e,0,p,m);e.__fm_extra&&b(e.__fm_extra,h,p,m-e.__fm_extra.getStyle("border-left-width").replace(/[^0-9]/g,"")-e.__fm_extra.getStyle("border-right-width").replace(/[^0-9]/g,"")-e.__fm_extra.getStyle("padding-right").replace(/[^0-9]/g,
"")-e.__fm_extra.getStyle("padding-left").replace(/[^0-9]/g,""))}else c(e),c(e.__fm_extra)}function d(h){"undefined"==typeof h.__fm_ghost&&(h.__fm_ghost=new Element("div"),h.__fm_ghost.hide(),h.insert({after:h.__fm_ghost}));h.__fm_ghost.clonePosition(h,{setWidth:!1})}function b(h,m,p,r){h&&(h.addClassName("floating-menu"),h.style.position="fixed",h.style.top=m+"px",h.style.left=p+"px",h.style.width=r+"px",h.__fm_ghost.show())}function c(h){h&&(h.removeClassName("floating-menu"),h.style.position="",
h.style.top="",h.style.left="",h.style.width="",h.__fm_ghost.hide())}if($("body").hasClassName("skin-colibri")){var e=$("contentmenu")||$("editmenu"),f=$("mainContentArea")||$("mainEditArea");e&&f&&(d(e),Event.observe(window,"resize",function(){if("fixed"==e.style.position&&(e.style.width=f.getWidth()+"px","undefined"!=typeof e.__fm_extra)){if("px"==e.__fm_extra.getStyle("padding-left").replace(/[^a-z]/g,"")){var h=e.__fm_extra.getStyle("border-left-width").replace(/[^0-9.]/g,"")-0;h+=e.__fm_extra.getStyle("padding-left").replace(/[^0-9.]/g,
"")-0;h+=e.__fm_extra.getStyle("padding-right").replace(/[^0-9.]/g,"")-0;h+=e.__fm_extra.getStyle("border-right-width").replace(/[^0-9.]/g,"")-0}else h=50;e.__fm_extra.style.width=f.getWidth()-h+"px"}}),browser.isIE6x||(Event.observe(window,"scroll",a),document.observe("xwiki:annotations:settings:loaded",a)))}});
require(["jquery"],function(a){var d=function(){return a("link[href], script[src]").map(function(){return a(this).attr("href")||a(this).attr("src")}).get()},b=function(e){var f;e=a("<div/>").html(e);e.find("link[href], script[src]").filter(function(){f||(f=d());var h=a(this).attr("href")||a(this).attr("src");return 0<=f.indexOf(h)}).remove();e.contents().appendTo("head")},c=function(e){b(e("X-XWIKI-HTML-HEAD"));setTimeout(function(){b(e("X-XWIKI-HTML-SCRIPTS"))},0)};a(function(){var e=window.XMLHttpRequest.prototype.open;
window.XMLHttpRequest.prototype.open=function(){this.addEventListener("load",function(){c(a.proxy(this,"getResponseHeader"))});return e.apply(this,arguments)}});a(function(){var e=window.fetch;e&&(window.fetch=function(){return e.apply(this,arguments).then(function(f){c(a.proxy(f.headers,"get"))})})})});
XWiki=function(a){var d=a.widgets=a.widgets||{};d.ModalPopup=Class.create({options:{globalDialog:!0,title:"",displayCloseButton:!0,extraClassName:!1,screenColor:"",borderColor:"",titleColor:"",backgroundColor:"",screenOpacity:"0.5",verticalPosition:"center",horizontalPosition:"center",removeOnClose:!1,onClose:Prototype.emptyFunction},initialize:function(b,c,e){this.shortcuts={show:{method:this.showDialog,keys:["Ctrl+G","Meta+G"]},close:{method:this.closeDialog,keys:["Esc"]}};this.content=b||"Hello world!";
this.shortcuts=Object.extend(Object.clone(this.shortcuts),c||{});this.options=Object.extend(Object.clone(this.options),e||{});this.registerShortcuts("show")},createDialog:function(b){this.dialog=new Element("div",{"class":"xdialog-modal-container"});b=(new Element("div",{"class":"xdialog-screen"})).setStyle({opacity:this.options.screenOpacity,backgroundColor:this.options.screenColor});this.dialog.update(b);this.dialogBox=new Element("div",{"class":"xdialog-box"});this.options.extraClassName&&this.dialogBox.addClassName(this.options.extraClassName);
this.dialogBox._x_contentPlug=new Element("div",{"class":"xdialog-content"});this.dialogBox.update(this.dialogBox._x_contentPlug);this.dialogBox._x_contentPlug.update(this.content);if(this.options.title){var c=(new Element("div",{"class":"xdialog-title"})).update(this.options.title);c.setStyle({color:this.options.titleColor});this.dialogBox.insertBefore(c,this.dialogBox.firstChild)}this.options.displayCloseButton&&(b=(new Element("div",{"class":"xdialog-close",title:"Close"})).update("&#215;"),b.observe("click",
this.closeDialog.bindAsEventListener(this)),this.options.title?(c.insert({bottom:b}),this.options.titleColor&&b.setStyle({color:this.options.titleColor})):this.dialogBox.insertBefore(b,this.dialogBox.firstChild));this.dialog.appendChild(this.dialogBox);this.dialogBox.setStyle({textAlign:"left",borderColor:this.options.borderColor,backgroundColor:this.options.backgroundColor});switch(this.options.verticalPosition){case "top":this.dialogBox.setStyle({top:"0"});break;case "bottom":this.dialogBox.setStyle({bottom:"0"});
break;default:this.dialogBox.setStyle({top:"35%"})}switch(this.options.horizontalPosition){case "left":this.dialog.setStyle({textAlign:"left"});break;case "right":this.dialog.setStyle({textAlign:"right"});break;default:this.dialog.setStyle({textAlign:"center"}),this.dialogBox.setStyle({margin:"auto"})}$("body").appendChild(this.dialog);this.dialog.hide()},setClass:function(b){this.dialogBox.addClassName("xdialog-box-"+b)},removeClass:function(b){this.dialogBox.removeClassName("xdialog-box-"+b)},setContent:function(b){this.content=
b;this.dialogBox._x_contentPlug.update(this.content)},showDialog:function(b){b&&Event.stop(b);if(this.options.globalDialog){if(d.ModalPopup.active)return;d.ModalPopup.active=!0}else{if(this.active)return;this.active=!0}this.dialog||this.createDialog();this.attachKeyListeners();this.dialog.show()},closeDialog:function(b){b&&Event.stop(b);this.options.onClose.call(this);this.dialog.hide();this.options.removeOnClose&&this.dialog.remove();this.detachKeyListeners();this.options.globalDialog?d.ModalPopup.active=
!1:this.active=!1},attachKeyListeners:function(){for(var b in this.shortcuts)"show"!=b&&this.registerShortcuts(b)},detachKeyListeners:function(){for(var b in this.shortcuts)"show"!=b&&this.unregisterShortcuts(b)},registerShortcuts:function(b){var c=this.shortcuts[b].keys,e=this.shortcuts[b].method.bindAsEventListener(this,b);b=this.shortcuts[b].options;for(var f=0;f<c.size();++f)shortcut.add(c[f],e,b)},unregisterShortcuts:function(b){for(var c=0;c<this.shortcuts[b].keys.size();++c)shortcut.remove(this.shortcuts[b].keys[c])},
createButton:function(b,c,e,f,h){var m=new Element("span",{"class":"buttonwrapper"});b=new Element("input",{type:b,"class":"button",value:c,title:e,id:f});h&&b.addClassName(h);m.update(b);return m}});d.ModalPopup.active=!1;return a}(XWiki||{});
/*
 #set ($paths = {
  'js': {
    'xwiki-suggestPages': $xwiki.getSkinFile('uicomponents/suggest/suggestPages.js', true)
  },
  'css': {
    'selectize': [
      $services.webjars.url('selectize.js', 'css/selectize.bootstrap3.css'),
      $xwiki.getSkinFile('uicomponents/suggest/xwiki.selectize.css', true)
    ]
  }
})
#set ($l10n = {
  'inputTooltip': $services.localization.render('core.viewers.jump.dialog.input.tooltip'),
  'viewLabel': $services.localization.render('core.viewers.jump.dialog.actions.view'),
  'viewTooltip': $services.localization.render('core.viewers.jump.dialog.actions.view.tooltip'),
  'editLabel': $services.localization.render('core.viewers.jump.dialog.actions.edit'),
  'editTooltip': $services.localization.render('core.viewers.jump.dialog.actions.edit.tooltip'),
  'content': $services.localization.render('core.viewers.jump.dialog.content')
})
#set ($shortcuts = {
  'show': 'core.viewers.jump.shortcuts',
  'view': 'core.viewers.jump.dialog.actions.view.shortcuts',
  'edit': 'core.viewers.jump.dialog.actions.edit.shortcuts'
})
#foreach ($entry in $shortcuts.entrySet())
  ## An action can have multiple  keyboard shortcuts associated (comma separated).
  #set ($values = $services.localization.render($entry.value).split('\s*,\s*'))
  #foreach ($value in $values)
    ## Each keyboard shortcut is wrapped in quotes because it was (poorly) designed to be injected direcly in JavaScript,
    ## which we don't do anymore. So we need to remove the quotes.
    #set ($discard = $values.set($foreach.index, $value.replaceAll('(^[''"])|([''"]$)', '')))
  #end
  #set ($discard = $entry.setValue($values))
#end
#[[*/
(function(a,d,b){require.config({paths:a.js});window.XWiki=window.XWiki||{};var c=XWiki.widgets=XWiki.widgets||{};if(XWiki.widgets.ModalPopup){var e=function(){return new c.JumpToPage};c.JumpToPage=Class.create(c.ModalPopup,{urlTemplate:(new XWiki.Document("__document__","__space__")).getURL("__action__"),initialize:function($super){var h=new Element("div");this.input=new Element("input",{type:"text",id:"jmp_target",title:d.inputTooltip});this.input.placeholder=this.input.title;h.appendChild(this.input);
this.viewButton=this.createButton("button",d.viewLabel,d.viewTooltip,"jmp_view");this.editButton=this.createButton("button",d.editLabel,d.editTooltip,"jmp_edit","secondary");var m=new Element("div",{"class":"buttons"});m.appendChild(this.viewButton);m.appendChild(this.editButton);h.appendChild(m);$super(h,{show:{method:this.showDialog,keys:b.show},view:{method:this.openDocument,keys:b.view,options:{propagate:!0}},edit:{method:this.openDocument,keys:b.edit}},{title:d.content,extraClassName:"jump-dialog",
verticalPosition:"top"});this.shortcuts.close.options={propagate:!0}},createDialog:function($super,h){Event.observe(this.viewButton,"click",this.openDocument.bindAsEventListener(this,"view"));Event.observe(this.editButton,"click",this.openDocument.bindAsEventListener(this,"edit"));$super(h);this.input.up(".xdialog-modal-container").addClassName("jump-dialog-container");var m=this;require(["jquery","xwiki-suggestPages"],function(p){a.css.selectize.forEach(function(q){p("<link/>").attr({type:"text/css",
rel:"stylesheet",href:q}).appendTo("head")});var r=function(q){var z=p(m.viewButton).add(m.editButton).find("input");!1===q?z.prop("disabled",!0):setTimeout(function(){z.prop("disabled",!1)},0)},t=function(q){r(""!==p(m.input).val())};p(m.input).on("change",t).suggestPages({maxItems:1});m.input.selectize.on("dropdown_open",p.proxy(r,null,!1));m.input.selectize.on("dropdown_close",t);m.input.selectize.focus();t()})},showDialog:function($super){$super();this.input.selectize?(this.input.selectize.clear(),
this.input.selectize.focus()):(this.input.value="",this.input.focus())},openDocument:function(f,h){this[(h||"view")+"Button"].down("input").disabled||(Event.stop(f),f=XWiki.Model.resolve(this.input.value,XWiki.EntityType.DOCUMENT,XWiki.currentDocument.documentReference),window.location=(new XWiki.Document(f)).getURL(h))}});XWiki.domIsLoaded&&e()||document.observe("xwiki:dom:loaded",e)}else console&&console.warn&&console.warn("[JumpToPage widget] Required class missing: XWiki.widgets.ModalPopup")}).apply("]]#",
$jsontool.serialize([$paths,$l10n,$shortcuts]));
"undefined"==typeof XWiki||"undefined"==typeof XWiki.widgets||"undefined"==typeof XWiki.widgets.ModalPopup?"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("[ConfirmationBox widget] Required class missing: XWiki.widgets.ModalPopup"):XWiki.widgets.ConfirmationBox=Class.create(XWiki.widgets.ModalPopup,{defaultInteractionParameters:{confirmationText:"$services.localization.render('core.widgets.confirmationBox.defaultQuestion')",yesButtonText:"$services.localization.render('core.widgets.confirmationBox.button.yes')",
noButtonText:"$services.localization.render('core.widgets.confirmationBox.button.no')",cancelButtonText:"$services.localization.render('core.widgets.confirmationBox.button.cancel')",showCancelButton:!1},initialize:function($super,d,b){this.interactionParameters=Object.extend(Object.clone(this.defaultInteractionParameters),b||{});b={show:{method:this.showDialog,keys:[]},yes:{method:this.onYes,keys:["Enter","Space","y"]},no:{method:this.onNo,keys:["n"]},close:{method:this.closeDialog,keys:["c"]}};this.interactionParameters.showCancelButton?
b.close.keys.push("Esc"):b.no.keys.push("Esc");$super(this.createContent(this.interactionParameters),b,{displayCloseButton:!1,removeOnClose:!0});this.showDialog();this.setClass("confirmation");this.behavior=d||{}},createContent:function(a){var d=(new Element("div",{"class":"question"})).update(a.confirmationText),b=new Element("div",{"class":"buttons"}),c=this.createButton("button",a.yesButtonText,"(Enter)","");Event.observe(c,"click",this.onYes.bindAsEventListener(this));b.insert(c);c=this.createButton("button",
a.noButtonText,a.showCancelButton?"(n)":"(Esc)","","secondary");Event.observe(c,"click",this.onNo.bindAsEventListener(this));b.insert(c);a.showCancelButton&&(a=this.createButton("button",a.cancelButtonText,"(Esc)","","cancel secondary"),Event.observe(a,"click",this.onCancel.bindAsEventListener(this)),b.insert(a));a=new Element("div");a.insert(d).insert(b);return a},onYes:function(a){this.closeDialog();if("function"==typeof this.behavior.onYes)this.behavior.onYes(a)},onNo:function(a){this.closeDialog();
if("function"==typeof this.behavior.onNo)this.behavior.onNo(a)},onCancel:function(a){this.closeDialog();if("function"==typeof this.behavior.onCancel)this.behavior.onCancel(a)}});
"undefined"==typeof XWiki||"undefined"==typeof XWiki.widgets||"undefined"==typeof XWiki.widgets.ConfirmationBox?"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("[MessageBox widget] Required class missing: XWiki.widgets.ModalPopup"):XWiki.widgets.ConfirmedAjaxRequest=Class.create(XWiki.widgets.ConfirmationBox,{defaultAjaxRequestParameters:{on1223:function(a){a.request.options.onSuccess(a)},on0:function(a){a.request.options.onFailure(a)}},initialize:function($super,d,b,c){this.interactionParameters=
Object.extend({displayProgressMessage:!0,progressMessageText:"$services.localization.render('core.widgets.confirmationBox.notification.inProgress')",displaySuccessMessage:!0,successMessageText:"$services.localization.render('core.widgets.confirmationBox.notification.done')",displayFailureMessage:!0,failureMessageText:"$services.localization.render('core.widgets.confirmationBox.notification.failed')"},c||{});this.requestUrl=d;this.ajaxRequestParameters=Object.extend(Object.clone(this.defaultAjaxRequestParameters),
b||{});Object.extend(this.ajaxRequestParameters,{onSuccess:function(){this.interactionParameters.displaySuccessMessage?this.progressNotification?this.progressNotification.replace(new XWiki.widgets.Notification(this.interactionParameters.successMessageText,"done")):new XWiki.widgets.Notification(this.interactionParameters.successMessageText,"done"):this.progressNotification&&this.progressNotification.hide();b.onSuccess&&b.onSuccess.apply(this,arguments)}.bind(this),onFailure:function(e){if(this.interactionParameters.displayFailureMessage){var f=
e.statusText;if(""==e.statusText||12031==e.status)f="Server not responding";this.progressNotification?this.progressNotification.replace(new XWiki.widgets.Notification(this.interactionParameters.failureMessageText+f,"error")):new XWiki.widgets.Notification(this.interactionParameters.failureMessageText+f,"error")}else this.progressNotification&&this.progressNotification.hide();b.onFailure&&b.onFailure.apply(this,arguments)}.bind(this)});$super({onYes:function(){this.interactionParameters.displayProgressMessage&&
(this.progressNotification=new XWiki.widgets.Notification(this.interactionParameters.progressMessageText,"inprogress"));new Ajax.Request(this.requestUrl,this.ajaxRequestParameters)}.bind(this)},this.interactionParameters)}});
XWiki=function(a){var d=a.widgets=a.widgets||{};d.Notification=Class.create({text:"Hello world!",defaultOptions:{plain:{timeout:5},info:{timeout:5},warning:{timeout:5},error:{timeout:10},inprogress:{timeout:!1},done:{timeout:2}},initialize:function(b,c,e){this.text=b||this.text;this.type="undefined"!=typeof this.defaultOptions[c]?c:"plain";this.options=Object.extend(Object.clone(this.defaultOptions[this.type]),e||{});this.createElement();this.options.inactive||this.show()},createElement:function(){this.element||
(this.element=(new Element("div",{"class":"xnotification xnotification-"+this.type})).update(this.text),this.options.icon&&this.element.setStyle({backgroundImage:this.options.icon,paddingLeft:"22px"}),this.options.backgroundColor&&this.element.setStyle({backgroundColor:this.options.backgroundColor}),this.options.color&&this.element.setStyle({color:this.options.color}),this.element=this.element.wrap(new Element("div",{"class":"xnotification-wrapper"})),Event.observe(this.element,"click",this.hide.bindAsEventListener(this)))},
show:function(){this.element.descendantOf(d.Notification.getContainer())||d.Notification.getContainer().insert({top:this.element});this.element.show();this.options.timeout&&(this.timer=window.setTimeout(this.hide.bind(this),1E3*this.options.timeout))},hide:function(){this.element.hide();this.element.parentNode&&this.element.remove();this.timer&&(window.clearTimeout(this.timer),this.timer=null);"function"==typeof this.options.onHide&&this.options.onHide()},replace:function(b){this.element.parentNode&&
this.element.replace(b.element);this.timer&&(window.clearTimeout(this.timer),this.timer=null);b.show()}});d.Notification.container=null;d.Notification.getContainer=function(){d.Notification.container||(d.Notification.container=new Element("div",{"class":"xnotification-container"}),$("body").insert(d.Notification.container));return d.Notification.container};return a}(XWiki||{});
XWiki=function(a){var d=a.widgets=a.widgets||{};d.XList=Class.create({initialize:function(b,c){this.items=b||[];this.options=c||{};this.listElement=new Element(this.options.ordered?"ol":"ul",{"class":"xlist"+(this.options.classes?" "+this.options.classes:"")});if(this.items&&0<this.items.length)for(b=0;b<this.items.length;b++)this.addItem(this.items[b])},addItem:function(b){b&&b instanceof a.widgets.XListItem||(b=new a.widgets.XListItem(b));var c=b.getElement();this.options.itemClasses&&!this.options.itemClasses.blank()&&
c.addClassName(this.options.itemClasses);this.listElement.insert(c);"object"==typeof this.options.eventListeners&&b.bindEventListeners(this.options.eventListeners);this.options.icon&&!this.options.icon.blank()&&b.setIcon(this.options.icon,this.options.overrideItemIcon);b.list=this},getElement:function(){return this.listElement}});d.XListItem=Class.create({initialize:function(b,c){this.options=c||{};c="xitem "+(this.options.noHighlight?"":"xhighlight ");c+=this.options.classes?this.options.classes:
"";this.containerElement=(new Element("div",{"class":"xitemcontainer"})).insert(b||"");this.containerElement.addClassName(this.options.containerClasses||"");this.containerElement.setStyle({textIndent:"0px"});this.options.value&&this.containerElement.insert((new Element("div",{"class":"hidden value"})).insert(this.options.value));this.listItemElement=(new Element("li",{"class":c})).update(this.containerElement);this.options.icon&&!this.options.icon.blank()&&(this.setIcon(this.options.icon),this.hasIcon=
!0);"object"==typeof this.options.eventListeners&&this.bindEventListeners(this.options.eventListeners)},getElement:function(){return this.listItemElement},setIcon:function(b,c){if(!this.hasIcon||c)this.iconImage=new Image,this.iconImage.onload=function(){this.listItemElement.setStyle({backgroundImage:"url("+this.iconImage.src+")",backgroundRepeat:"no-repeat",backgroundPosition:"3px 3px"});this.listItemElement.down(".xitemcontainer").setStyle({textIndent:this.iconImage.width+6+"px"})}.bind(this),this.iconImage.src=
b},bindEventListeners:function(b){for(var c=Object.keys(b),e=0;e<c.length;e++)this.listItemElement.observe(c[e],b[c[e]].bindAsEventListener(this.options.eventCallbackScope?this.options.eventCallbackScope:this))}});return a}(XWiki||{});
XWiki=function(a){var d=a.widgets=a.widgets||{};"undefined"==typeof d.XList?"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("[Suggest widget] Required class missing: XWiki.widgets.XList"):d.Suggest=Class.create({options:{minchars:1,method:"get",varname:"input",className:"ajaxsuggest",timeout:2500,delay:500,offsety:0,shownoresults:!0,noresults:"$services.localization.render('core.widgets.suggest.noResults')",maxheight:250,cache:!1,seps:"",icon:null,resultsParameter:"results",
resultId:"id",resultValue:"value",resultInfo:"info",resultInfoHTML:!1,resultIcon:"icon",resultHint:"hint",resultType:"type",resultURL:"url",parentContainer:"body",highlight:!0,fadeOnClear:!0,hideButton:{positions:["top"],text:"$escapetool.javascript($services.localization.render('core.widgets.suggest.hide'))"},insertBeforeSuggestions:null,displayValue:!1,displayValueText:"$services.localization.render('core.widgets.suggest.valuePrefix')",align:"left",unifiedLoader:!1,loaderNode:null,propagateEventKeyCodes:[]},
sInput:"",nInputChars:0,aSuggestions:{},iHighlighted:null,isActive:!1,initialize:function(b,c){if(!b)return!1;this.setInputField(b);this.options=Object.extend(Object.clone(this.options),c||{});"object"==typeof this.options.sources?(this.isInMultiSourceMode=!0,this.sources=this.options.sources):this.sources=this.options;this.sources=[this.sources].flatten().compact();0==this.sources.length&&this.sources.push({script:function(e,f){f([])}});$(this.options.parentContainer)||(this.options.parentContainer=
$(document.body));this.seps=this.options.seps?this.options.seps:"";this.latestRequest=0},setInputField:function(b){this.detach();this.fld=$(b);this.fld.__x_suggest&&this.fld.__x_suggest.detach();this.fld.__x_suggest=this;this.onKeyUp=this.onKeyUp.bindAsEventListener(this);this.fld.observe("keyup",this.onKeyUp);this.onKeyPress=this.onKeyPress.bindAsEventListener(this);Prototype.Browser.IE||Prototype.Browser.WebKit||browser.isIE11up?this.fld.observe("keydown",this.onKeyPress):this.fld.observe("keypress",
this.onKeyPress);this.fld.setAttribute("autocomplete","off");this.fld.observe("blur",function(c){this.latestRequest++}.bind(this))},onKeyUp:function(b){switch(b.keyCode){case Event.KEY_RETURN:case Event.KEY_ESC:case Event.KEY_UP:case Event.KEY_DOWN:break;default:if(this.seps){b=-1;for(var c=0;c<this.seps.length;c++)this.fld.value.lastIndexOf(this.seps.charAt(c))>b&&(b=this.fld.value.lastIndexOf(this.seps.charAt(c)));-1==b?this.getSuggestions(this.fld.value):this.getSuggestions(this.fld.value.substring(b+
1))}else this.getSuggestions(this.fld.value)}},onKeyPress:function(b){if($(this.isActive)){var c=b.keyCode,e=!0;switch(c){case Event.KEY_RETURN:this.iHighlighted||1!=Object.keys(this.aSuggestions).length||1!=this.aSuggestions[Object.keys(this.aSuggestions)[0]].length||this.highlightFirst();this.setHighlightedValue(b);break;case Event.KEY_ESC:this.clearSuggestions();break;case Event.KEY_UP:this.changeHighlight(c);break;case Event.KEY_DOWN:this.changeHighlight(c);break;default:e=!1}e&&this.options.propagateEventKeyCodes&&
-1==this.options.propagateEventKeyCodes.indexOf(c)&&Event.stop(b)}},getSuggestions:function(b){b=b.strip().toLowerCase();if(b==this.sInput)return!1;if(b.length<this.options.minchars)return this.sInput="",this.clearSuggestions(),!1;if(b.length>this.nInputChars&&Object.keys(this.aSuggestions).length&&this.options.cache){for(var c={},e=0;e<Object.keys(this.aSuggestions).length;e++){for(var f=Object.keys(this.aSuggestions)[e],h=[],m=0;m<this.aSuggestions[f].length;m++){var p=this.aSuggestions[f][m];p.value.substr(0,
b.length).toLowerCase()==b&&h.push(p)}h.length&&(c[f]=r)}this.sInput=b;this.nInputChars=b.length;this.aSuggestions=c;for(e=0;e<sources.length;e++){b=sources[e];var r=this.aSuggestions[b.id];r&&this.createList(r,b)}}else{this.sInput=b;this.nInputChars=b.length;this.prepareContainer();this.latestRequest++;var t=this,q=this.latestRequest;clearTimeout(this.ajID);this.container.select(".hide-button-wrapper").invoke("hide");this.ajID=setTimeout(function(){t.doAjaxRequests(q)},this.options.delay)}return!1},
doAjaxRequests:function(b,c){if(!(this.fld.value.length<this.options.minchars))for(var e=0;e<this.sources.length;e++){var f=this.sources[e];"function"==typeof f.script?(this.fld.addClassName("loading"),f.script(this.fld.value.strip(),function(h){b==this.latestRequest&&(this.aSuggestions[f.id]=h||[],h&&this.createList(this.aSuggestions[f.id],f),this.fld.removeClassName("loading"))}.bind(this))):this.doAjaxRequest(f,b,c)}},doAjaxRequest:function(b,c,e){var f=b.script+(0>b.script.indexOf("?")?"?":"&")+
b.varname+"="+encodeURIComponent(this.fld.value.strip()),h=b.method||"get",m={};m.Accept=b.json?"application/json":"application/xml";b={method:h,requestHeaders:m,onCreate:this.fld.addClassName.bind(this.fld,"loading"),onSuccess:this.setSuggestions.bindAsEventListener(this,b,c),onFailure:function(p){new a.widgets.Notification("$services.localization.render('core.widgets.suggest.transportError')"+p.statusText,"error",{timeout:5})},onComplete:this.fld.removeClassName.bind(this.fld,"loading")};b.defaultValues=
Object.clone(b);new Ajax.Request(f,Object.extend(b,e||{}))},setSuggestions:function(b,c,e){e<this.latestRequest||(b=this.parseResponse(b,c),this.aSuggestions[c.id]=b||[],b&&this.createList(this.aSuggestions[c.id],c))},_getNestedProperty:function(b,c){for(c=c.split(".");c.length&&(b=b[c.shift()]););return 0<c.length?null:b},parseResponse:function(b,c){var e=[];if(c.json){b=b.responseJSON;if(!b)return null;b=Object.isArray(b)?b:this._getNestedProperty(b,c.resultsParameter||this.options.resultsParameter);
for(var f=0;f<b.length;f++){var h=b[f];e.push({id:this._getNestedProperty(h,c.resultId||this.options.resultId),value:this._getNestedProperty(h,c.resultValue||this.options.resultValue),info:this._getNestedProperty(h,c.resultInfo||this.options.resultInfo),icon:this._getNestedProperty(h,c.resultIcon||this.options.resultIcon),hint:this._getNestedProperty(h,c.resultHint||this.options.resultHint),type:this._getNestedProperty(h,c.resultType||this.options.resultType),url:this._getNestedProperty(h,c.resultURL||
this.options.resultURL)})}}else for(b=b.responseXML.getElementsByTagName(c.resultsParameter||this.options.resultsParameter)[0].childNodes,f=0;f<b.length;f++)b[f].hasChildNodes()&&e.push({id:b[f].getAttribute("id"),value:b[f].childNodes[0].nodeValue,info:b[f].getAttribute("info"),icon:b[f].getAttribute("icon"),hint:b[f].getAttribute("hint"),type:b[f].getAttribute("type"),url:b[f].getAttribute("url")});return e},prepareContainer:function(){if(!$(this.options.parentContainer).down(".suggestItems")){var b=
new Element("div",{"class":"suggestItems "+this.options.className}),c="body"==$(this.options.parentContainer).tagName.toLowerCase()?this.fld.cumulativeOffset():this.fld.positionedOffset(),e=this.fld.offsetWidth-2,f=this.options.width||e,h=this.fld.viewportOffset().left,m=$("body").getWidth();b.style.left="left"==this.options.align||"auto"==this.options.align&&h+this.options.width<m?c.left+"px":"center"==this.options.align?c.left+(e-f)/2+"px":c.left+e-f+"px";b.style.top=c.top+this.fld.offsetHeight+
this.options.offsety+"px";b.style[this.options.width?"width":"minWidth"]=f+"px";var p=this;b.onmouseover=function(){p.killTimeout()};b.onmouseout=function(){p.resetTimeout()};this.resultContainer=new Element("div",{"class":"resultContainer"});b.appendChild(this.resultContainer);$(this.options.parentContainer).insert(b);this.container=b;this.options.insertBeforeSuggestions&&this.resultContainer.insert(this.options.insertBeforeSuggestions);document.fire("xwiki:suggest:containerCreated",{container:this.container,
suggest:this})}if(this.isInMultiSourceMode)for(b=0;b<this.sources.length;b++)c=this.sources[b],c.id=c.id||b,this.resultContainer.down(".results"+c.id)?(this.resultContainer.down(".results"+c.id).down("ul")&&this.resultContainer.down(".results"+c.id).down("ul").remove(),this.options.unifiedLoader?((this.options.loaderNode||this.fld).addClassName("loading"),this.resultContainer.down(".results"+c.id).addClassName("hidden").addClassName("loading")):this.resultContainer.down(".results"+c.id).down(".sourceContent").addClassName("loading")):
(e=new Element("div",{"class":"results results"+c.id}),f=new Element("div",{"class":"sourceName"}),this.options.unifiedLoader&&e.addClassName("hidden").addClassName("loading"),"undefined"!=typeof c.icon&&(h=new Image,h.onload=function(){this.sourceHeader.setStyle({backgroundImage:"url("+this.iconImage.src+")"});this.sourceHeader.setStyle({textIndent:this.iconImage.width+6+"px"})}.bind({sourceHeader:f,iconImage:h}),h.src=c.icon),f.insert(c.name),e.insert(f),e.insert(new Element("div",{"class":"sourceContent "+
(this.options.unifiedLoader?"":"loading")})),"undefined"!==typeof c.before&&this.resultContainer.insert(c.before),this.resultContainer.insert(e),"undefined"!==typeof c.after&&this.resultContainer.insert(c.after));else this.resultContainer.down("ul")&&this.resultContainer.down("ul").remove();if("undefined"!==typeof this.options.hideButton&&"object"===typeof this.options.hideButton.positions&&0<this.options.hideButton.positions.length&&!this.container.down(".hide-button"))for(c=this.options.hideButton.positions,
b=0;b<c.length;b++)e=(new Element("span",{"class":"hide-button"})).update(this.options.hideButton.text),f={},f[c[b]]=(new Element("div",{"class":"hide-button-wrapper"})).update(e),e.observe("click",this.clearSuggestions.bindAsEventListener(this)),this.container.insert(f);this.container.fire("xwiki:suggest:containerPrepared",{container:this.container,suggest:this});return this.container},createList:function(b,c){this._createList(b,c);this.isInMultiSourceMode&&this.resultContainer.down(".results.loading")||
document.fire("xwiki:suggest:updated",{container:this.container,suggest:this})},_createList:function(b,c){this.isActive=!0;var e=this;this.killTimeout();if(this.isInMultiSourceMode){var f=this.resultContainer.down(".results"+c.id);f.removeClassName("loading");f.down(".sourceContent").removeClassName("loading");(0<b.length||this.options.shownoresults)&&f.removeClassName("hidden");this.options.unifiedLoader&&!this.resultContainer.down(".results.loading")&&(this.options.loaderNode||this.fld).removeClassName("loading")}else f=
this.resultContainer;if(0==b.length&&!this.options.shownoresults)return!1;f.down("ul")&&f.down("ul").remove();this.container.select(".hide-button-wrapper").invoke("show");for(var h=new a.widgets.XList([],{icon:this.options.icon,classes:"suggestList",eventListeners:{click:function(t){e.setHighlightedValue(t);return!1},mouseover:function(){e.setHighlight(this.getElement())}}}),m=0,p=b.length;m<p;m++){var r=function(t){return((t||"")+"").escapeHTML()};r=(new Element("div")).insert((new Element("span",
{"class":"suggestId"})).update(r(b[m].id))).insert((new Element("span",{"class":"suggestValue"})).update(r(b[m].value))).insert((new Element("span",{"class":"suggestInfo"})).update(r(b[m].info))).insert((new Element("span",{"class":"suggestURL"})).update(r(b[m].url)));r=new a.widgets.XListItem(this.createItemDisplay(b[m],c),{containerClasses:"suggestItem "+(b[m].type||""),value:r,noHighlight:!0});h.addItem(r)}0==b.length&&h.addItem(new a.widgets.XListItem(this.options.noresults,{classes:"noSuggestion",
noHighlight:!0}));f.appendChild(h.getElement());this.suggest=f;e=this;0<this.options.timeout&&(this.toID=setTimeout(function(){e.clearSuggestions()},this.options.timeout))},createItemDisplay:function(b,c){var e=this.sInput?this.sInput.escapeHTML():this.sInput,f=((b.value||"")+"").escapeHTML();e=c.highlight?this.emphasizeMatches(e,f):f;b.hint&&(f=(b.hint+"").escapeHTML(),e+="<span class='hint'>"+f+"</span>");this.options.displayValue?(e=(new Element("div")).insert((new Element("div",{"class":"value"})).update(e)),
b.info&&(f=b.info+"",(void 0===c.resultInfoHTML?this.options.resultInfoHTML:c.resultInfoHTML)||(f=f.escapeHTML()),e.insert((new Element("div",{"class":"info"})).update("<span class='legend'>"+this.options.displayValueText+"</span>"+f)))):e=(new Element("span",{"class":"info"})).update(e);b.icon&&(b=0<=b.icon.indexOf(".")||0<=b.icon.indexOf("/")?new Element("img",{src:b.icon,"class":"icon"}):new Element("i",{"class":"icon "+b.icon}),e.insert({top:b}));return e},emphasizeMatches:function(b,c){if(!b)return c;
var e=c;b=b.split(/\s+/).uniq().compact();var f=0,h={};c=0;for(var m=b.length;c<m;c++)for(var p=e.toLowerCase().indexOf(b[c].toLowerCase());0<=p;){var r=e.substring(p,p+b[c].length),t="";b[c].length.times(function(){t+=" "});h[p]=r;e=e.substring(0,p)+t+e.substring(p+b[c].length);p=e.toLowerCase().indexOf(b[c].toLowerCase())}Object.keys(h).sortBy(function(q){return parseInt(q)}).each(function(q){var z=e.substring(0,parseInt(q)+f),B=e.substring(parseInt(q)+h[q].length+f);e=z+"<em>"+h[q]+"</em>"+B;f+=
9});return e},changeHighlight:function(b){var c=this.resultContainer;if(!c)return!1;if(this.iHighlighted)if(b==Event.KEY_DOWN){var e=this.iHighlighted.next();if(!e&&this.iHighlighted.up("div.results"))for(b=this.iHighlighted.up("div.results").next();b&&!e;)e=b.down("li"),b=b.next();e||(e=c.down("li"))}else{if(b==Event.KEY_UP){e=this.iHighlighted.previous();if(!e&&this.iHighlighted.up("div.results"))for(b=this.iHighlighted.up("div.results").previous();b&&!e;)e=b.down("li:last-child"),b=b.previous();
e||(e=c.select("ul")[c.select("ul").length-1].down("li:last-child"))}}else b==Event.KEY_DOWN?e=c.down("div.results")?c.down("div.results").down("li"):c.down("li"):b==Event.KEY_UP&&0<c.select("li")&&(e=c.select("li")[c.select("li").length-1]);e&&this.setHighlight(e)},setHighlight:function(b){this.iHighlighted&&this.clearHighlight();b.addClassName("xhighlight");this.iHighlighted=b;this.killTimeout()},clearHighlight:function(){this.iHighlighted&&(this.iHighlighted.removeClassName("xhighlight"),delete this.iHighlighted)},
highlightFirst:function(){if(this.suggest&&this.suggest.down("ul")){var b=this.suggest.down("ul").down("li");b&&this.setHighlight(b)}},hasActiveSelection:function(){return this.iHighlighted},setHighlightedValue:function(b){if(this.iHighlighted&&!this.iHighlighted.hasClassName("noSuggestion")){var c=function(h){return h.textContent||h.innerText},e=this.iHighlighted.down("img.icon");c={suggest:this,id:c(this.iHighlighted.down(".suggestId")),value:c(this.iHighlighted.down(".suggestValue")),info:c(this.iHighlighted.down(".suggestInfo")),
url:c(this.iHighlighted.down(".suggestURL")),icon:e?e.src:"",originalEvent:b};if(""==this.sInput&&""==this.fld.value)var f=e=c.value;else if(this.seps){b=-1;for(e=0;e<this.seps.length;e++)this.fld.value.lastIndexOf(this.seps.charAt(e))>b&&(b=this.fld.value.lastIndexOf(this.seps.charAt(e)));-1==b?f=e=c.value:(e=this.fld.value.substring(0,b+1)+c.value,f=e.substring(b+1))}else f=e=c.value;b=Event.fire(this.fld,"xwiki:suggest:selected",Object.clone(c));!b.stopped&&(this.sInput=f,this.fld.value=e,this.fld.focus(),
this.clearSuggestions(),"function"==typeof this.options.callback&&this.options.callback(Object.clone(c)),0<this.fld.id.indexOf("_suggest")&&(b=this.fld.id.substring(0,this.fld.id.indexOf("_suggest")),b=$(b)))&&(b.value=c.info)}},killTimeout:function(){clearTimeout(this.toID)},resetTimeout:function(){clearTimeout(this.toID);var b=this;this.toID=setTimeout(function(){b.clearSuggestions()},1E3)},clearSuggestions:function(){this.clearHighlight();this.killTimeout();this.isActive=!1;var b=$(this.container),
c=this;b&&b.parentNode&&(this.options.fadeOnClear&&window.Effect?new Effect.Fade(b,{duration:"0.25",afterFinish:function(){$(c.container)&&$(c.container).remove()}}):$(this.container).remove(),document.fire("xwiki:suggest:clearSuggestions",{suggest:this}))},detach:function(){this.fld&&(Event.stopObserving(this.fld,"keyup",this.onKeyUp),Prototype.Browser.IE||Prototype.Browser.WebKit?Event.stopObserving(this.fld,"keydown",this.onKeyPress):Event.stopObserving(this.fld,"keypress",this.onKeyPress),this.clearSuggestions(),
this.fld.__x_suggest=null,this.fld.setAttribute("autocomplete","on"))}});return a}(XWiki||{});

//# sourceMappingURL=xwiki.bundle.min.js.map
