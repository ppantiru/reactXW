function computeBounds(){leftPanelsLeft=getX(leftPanels);leftPanelsRight=leftPanelsLeft+leftPanels.offsetWidth;rightPanelsLeft=getX(rightPanels);rightPanelsRight=rightPanelsLeft+rightPanels.offsetWidth;allpanelsLeft=getX(allPanels);allpanelsTop=getY(allPanels)}function debugwrite(a){document.getElementById("headerglobal").appendChild(document.createTextNode(a))}function isPanel(a){return a&&1===a.nodeType&&a.classList.contains("panel")&&$(a).up("#leftPanels, #rightPanels, #allviewpanels")}
function getX(a){return a.offsetParent?window.ActiveXObject?a.offsetLeft+getX(a.offsetParent)+a.clientLeft:a.offsetLeft+getX(a.offsetParent)+(a.scrollWidth-a.clientWidth):a.x?a.x:0}function getY(a){return a.offsetParent?window.ActiveXObject?a.offsetTop+getY(a.offsetParent)+a.clientTop:a.offsetTop+getY(a.offsetParent)+(a.scrollHeight-a.clientHeight):a.y?a.y:0}
function getBlocList(a){for(var b=[],c=a.childNodes.length,d=0;d<c;++d){var e=a.childNodes[d];isPanel(e)&&(e.isDragging||b.push(e))}return b}function getDragBoxPos(a,b){b=a.length;if(0==b)return 0;for(var c=0;c<b;++c)if(a[c]==dragel)return c;return-1}function getAllPanels(a){var b=[];a=a.getElementsByTagName("div");for(var c=0,d=0;d<a.length;++d)isPanel(a[d])&&(b[c]=a[d],c++);return b}
function getClosestDropTarget(a,b,c,d){return 1==window.showLeftColumn&&a<=leftPanelsRight&&a+c>=leftPanelsLeft?leftPanels:1==window.showRightColumn&&a+c>=rightPanelsLeft&&a<=rightPanelsRight?rightPanels:allPanels}
function onDragStart(a,b,c){if(!a.isDragging){hideTip();window.isDraggingPanel=!0;1==enabletip&&hideTip();parentNode=realParent=a.parentNode;var d=realParent!=leftPanels&&realParent!=rightPanels;c=Position.cumulativeOffset(a);var e=Position.realOffset(a);b=c[0];c=c[1]-e[1]+(document.documentElement.scrollTop-0+document.body.scrollTop-0);dragel.style.height=window.ActiveXObject?(a.offsetHeight?a.offsetHeight:a.displayHeight)+"px":(a.offsetHeight?a.offsetHeight-2:a.displayHeight)+"px";dragel.style.display=
"block";a.style.left=b+"px";a.style.top=c+"px";a.style.zIndex="10";d?(parentNode=allPanels,a.placeholder=document.createElement("div"),a.placeholder.className="placeholder",a.placeholder.style.height=window.ActiveXObject?(a.offsetHeight?a.offsetHeight:a.displayHeight)+"px":(a.offsetHeight?a.offsetHeight-2:a.displayHeight)+"px",realParent.replaceChild(a.placeholder,a),a.placeholder.style.display="block",addClass(allPanels,"dropTarget")):realParent.replaceChild(dragel,a);a.style.position="absolute";
document.body.appendChild(a);a.isDragging=!0;prevcolumn=parentNode}}
function onDrag(a,b,c){1==enabletip&&hideTip();parentNode=getClosestDropTarget(b,c,a.offsetWidth,a.offsetHeight);parentNode!=prevcolumn&&(prevcolumn!=allPanels&&prevcolumn.removeChild(dragel),parentNode!=allPanels?(parentNode.appendChild(dragel),rmClass(allPanels,"dropTarget")):addClass(allPanels,"dropTarget"));prevcolumn=parentNode;a=getBlocList(parentNode);b=getDragBoxPos(a,c);-1!=b&&(0==a.length?parentNode!=allPanels&&parentNode.appendChild(dragel):0!=b&&c<=getY(a[b-1])?parentNode.insertBefore(dragel,
a[b-1]):b!=a.length-1&&c>=getY(a[b+1])&&(a[b+2]?parentNode.insertBefore(dragel,a[b+2]):parentNode!=allPanels?parentNode.appendChild(dragel):dragel.parentNode.removeChild(dragel)))}function onDragEnd(a,b,c){a.isDragging=!1;window.isDraggingPanel=!1;a.style.position="static";parentNode==allPanels?(a.placeholder.parentNode.replaceChild(a,a.placeholder),a.placeholder=void 0,rmClass(allPanels,"dropTarget")):parentNode.replaceChild(a,dragel);dragel.style.display="none";updatePanelLayout()}
var updatePanelLayout=function(){leftPanelsInput&&!leftPanelsInput.disabled&&(leftPanelsInput.value=getBlocNameList(leftPanels));rightPanelsInput&&!rightPanelsInput.disabled&&(rightPanelsInput.value=getBlocNameList(rightPanels))};
function executeCommand(a,b){function c(){4==d.readyState&&(200==d.status?e?e(d.responseText):new XWiki.widgets.Notification("no callback defined","error"):new XWiki.widgets.Notification("There was a problem retrieving the xml data:\n"+d.status+":\t"+d.statusText+"\n"+d.responseText,"error"))}var d=null,e=b;window.XMLHttpRequest?(d=new XMLHttpRequest,d.onreadystatechange=c,d.open("GET",a,!0),d.send(null)):window.ActiveXObject?(d=new ActiveXObject("Microsoft.XMLHTTP"),d.onreadystatechange=c,d.open("GET",
a,!0),d.send()):new XWiki.widgets.Notification("your browser does not support xmlhttprequest","error")}
function start1(){var a;var b=document.getElementsByTagName("div");for(a=0;a<b.length;++a){var c=b[a];isPanel(c)&&attachDragHandler(c)}window.panelsInList=getAllPanels(allPanels);window.panelsOnLeft=getBlocList(leftPanels);window.panelsOnRight=getBlocList(rightPanels);for(a=0;a<panelsInList.length;++a)b=window.allPanelsPlace[a].left,-1!=b&&(c=panelsOnLeft[b])&&(c.fullname=window.allPanelsPlace[a].fullname,c.placeholder=document.createElement("div"),c.placeholder.className="placeholder",c.displayHeight=
window.ActiveXObject?c.offsetHeight?c.offsetHeight:0:c.offsetHeight?c.offsetHeight-2:0,c.placeholder.style.height=c.displayHeight+"px",c.placeholder.style.display="block",panelsInList[a].parentNode.replaceChild(c.placeholder,panelsInList[a])),b=window.allPanelsPlace[a].right,-1!=b&&(c=panelsOnRight[b])&&(c.fullname=window.allPanelsPlace[a].fullname,c.placeholder=document.createElement("div"),c.placeholder.className="placeholder",c.displayHeight=window.ActiveXObject?c.offsetHeight?c.offsetHeight:0:
c.offsetHeight?c.offsetHeight-2:0,c.placeholder.style.height=c.displayHeight+"px",c.placeholder.style.display="block",panelsInList[a].parentNode&&panelsInList[a].parentNode.replaceChild(c.placeholder,panelsInList[a])),panelsInList[a].fullname=window.allPanelsPlace[a].fullname;leftPanels.savedPanelList=getBlocList(leftPanels);rightPanels.savedPanelList=getBlocList(rightPanels);leftPanels.isVisible=window.showLeftColumn;rightPanels.isVisible=window.showRightColumn;leftPanels.isVisible||(leftPanels.panels=
getBlocList(leftPanels));rightPanels.isVisible||(rightPanels.panels=getBlocList(rightPanels));layoutMaquettes=$("PageLayoutSection").select(".pagelayoutoption")}function attachDragHandler(a){a.ondblclick=function(b){};Drag.init(a,a);a.onDragStart=function(b,c){onDragStart(this,b,c)};a.onDrag=function(b,c){onDrag(this,b,c)};a.onDragEnd=function(b,c){onDragEnd(this,b,c)}}function isAttachedPanel(a){return a.ondblclick?!0:!1}
function getBlocNameList(a){for(var b="",c=a.childNodes.length,d=0;d<c;++d){var e=a.childNodes[d];isPanel(e)&&!e.isDragging&&(""!=b&&(b+=","),b+=e.fullname)}return b}
function save(){url=window.ajaxurl;url+="&showLeftPanels="+window.showLeftColumn;url+="&showRightPanels="+window.showRightColumn;if(window.showLeftColumn){var a=leftPanelsInput?leftPanelsInput.value:getBlocNameList(leftPanels);url+="&leftPanels="+encodeURIComponent(a);url+="&leftPanelsWidth="+leftPanelsWidthInput.value}window.showRightColumn&&(a=rightPanelsInput?rightPanelsInput.value:getBlocNameList(rightPanels),url+="&rightPanels="+encodeURIComponent(a),url+="&rightPanelsWidth="+rightPanelsWidthInput.value);
executeCommand(url,saveResult)}function saveResult(a){"SUCCESS"==a?(new XWiki.widgets.Notification(window.panelsavesuccess,"done"),leftPanels.savedPanelList=getBlocList(leftPanels),rightPanels.savedPanelList=getBlocList(rightPanels),leftPanels.isVisible=window.showLeftColumn,rightPanels.isVisible=window.showRightColumn):(alert(window.panelsaveerror),alert(a))}function releasePanels(a){a.panels=getBlocList(a);for(var b=0;b<a.panels.length;++b)releasePanel(a.panels[b])}
function releasePanel(a){a.parentNode.removeChild(a);a.placeholder.parentNode.replaceChild(a,a.placeholder);a.placeholder=void 0}function restorePanels(a){for(var b=0;b<a.panels.length;++b)a.panels[b].placeholder||restorePanel(a.panels[b],a);a.panels=void 0}function revertPanels(a){for(var b=0;b<a.savedPanelList.length;++b)restorePanel(a.savedPanelList[b],a)}
function restorePanel(a,b){a.placeholder=document.createElement("div");a.placeholder.className="placeholder";a.placeholder.style.height=window.ActiveXObject?a.offsetHeight?a.offsetHeight:0:a.offsetHeight?a.offsetHeight-2:0;a.placeholder.style.display="block";a.parentNode.replaceChild(a.placeholder,a);b.appendChild(a)}
function changePreviewLayout(a,b){document.getElementById("selectedoption").id="";a.id="selectedoption";mainContainer.removeClassName("hidelefthideright");mainContainer.removeClassName("hideright");mainContainer.removeClassName("hideleft");mainContainer.removeClassName("content");switch(b){case 0:1==window.showLeftColumn&&(window.showLeftColumn=0,leftPanels.style.display="none",releasePanels(leftPanels));1==window.showRightColumn&&(window.showRightColumn=0,rightPanels.style.display="none",releasePanels(rightPanels));
mainContainer.addClassName("hidelefthideright");leftPanelsInput&&leftPanelsInput.disable();leftPanelsWidthInput.disable();rightPanelsInput&&rightPanelsInput.disable();rightPanelsWidthInput.disable();break;case 1:0==window.showLeftColumn&&(window.showLeftColumn=1,leftPanels.style.display="block",restorePanels(leftPanels));1==window.showRightColumn&&(window.showRightColumn=0,rightPanels.style.display="none",releasePanels(rightPanels));mainContainer.addClassName("hideright");leftPanelsInput&&leftPanelsInput.enable();
leftPanelsWidthInput.enable();rightPanelsInput&&rightPanelsInput.disable();rightPanelsWidthInput.disable();break;case 2:1==window.showLeftColumn&&(window.showLeftColumn=0,leftPanels.style.display="none",releasePanels(leftPanels));0==window.showRightColumn&&(window.showRightColumn=1,rightPanels.style.display="block",restorePanels(rightPanels));mainContainer.addClassName("hideleft");leftPanelsInput&&leftPanelsInput.disable();leftPanelsWidthInput.disable();rightPanelsInput&&rightPanelsInput.enable();
rightPanelsWidthInput.enable();break;case 3:0==window.showLeftColumn&&(window.showLeftColumn=1,leftPanels.style.display="block",restorePanels(leftPanels)),0==window.showRightColumn&&(window.showRightColumn=1,rightPanels.style.display="block",restorePanels(rightPanels)),mainContainer.addClassName("content"),leftPanelsInput&&leftPanelsInput.enable(),leftPanelsWidthInput.enable(),rightPanelsInput&&rightPanelsInput.enable(),rightPanelsWidthInput.enable()}computeBounds()}
function revert(){releasePanels(leftPanels);releasePanels(rightPanels);revertPanels(leftPanels);revertPanels(rightPanels);var a=0;leftPanels.isVisible&&(a+=1);rightPanels.isVisible&&(a+=2);setPanelWidth();changePreviewLayout(layoutMaquettes[a],a);updatePanelLayout()}
function setPanelWidth(){for(var a=["Small","Medium","Large"],b=0;b<a.length;++b){var c=a[b];mainContainer.removeClassName("panel-left-width-"+c);mainContainer.removeClassName("panel-right-width-"+c);window.leftPanels.removeClassName("panel-width-"+c);window.rightPanels.removeClassName("panel-width-"+c)}c=b="Medium";0<=a.indexOf(leftPanelsWidthInput.value)&&(b=leftPanelsWidthInput.value);0<=a.indexOf(rightPanelsWidthInput.value)&&(c=rightPanelsWidthInput.value);mainContainer.addClassName("panel-left-width-"+
b);mainContainer.addClassName("panel-right-width-"+c);window.leftPanels.addClassName("panel-width-"+b);window.rightPanels.addClassName("panel-width-"+c)}
function panelEditorInit(){tipobj=$("dhtmltooltip");realParent=parentNode=null;dragel=new Element("div",{id:"dragbox","class":"panel"});nb=dragWidth=0;layoutMaquetes=null;window.leftPanels=$("leftPanels");window.rightPanels=$("rightPanels");allPanels=$("allviewpanels");mainContent=$("contentcolumn");mainContainer=$("body");leftPanelsLeft=getX(leftPanels);leftPanelsRight=leftPanelsLeft+leftPanels.offsetWidth;rightPanelsLeft=getX(rightPanels);rightPanelsRight=rightPanelsLeft+rightPanels.offsetWidth;
allpanelsLeft=getX(allPanels);allpanelsTop=getY(allPanels);leftPanelsInput=$("XWiki.XWikiPreferences_0_leftPanels");leftPanelsWidthInput=$("XWiki.XWikiPreferences_0_leftPanelsWidth");rightPanelsInput=$("XWiki.XWikiPreferences_0_rightPanels");rightPanelsWidthInput=$("XWiki.XWikiPreferences_0_rightPanelsWidth");leftPanelsWidthInput.observe("change",setPanelWidth);rightPanelsWidthInput.observe("change",setPanelWidth);prevcolumn=allPanels;start1();var a=$("selectedoption");changePreviewLayout(a,a.previousSiblings().size())}
function waitForAsync(a){!document.getElementsByClassName("xwiki-async").length||1E3<a?panelEditorInit():setTimeout(waitForAsync,10,a+10)}waitForAsync(0);

//# sourceMappingURL=panelWizard.min.js.map
